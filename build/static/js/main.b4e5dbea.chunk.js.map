{"version":3,"sources":["router/Loading.tsx","router/Error.tsx","apollo/query.ts","components/Datepicker.tsx","components/AppLogo.tsx","components/AppNav.tsx","components/KindBar.tsx","components/Datebar.tsx","apollo/mutation.ts","components/ShiftTable.tsx","apollo/subscriptions.ts","components/ShiftView.tsx","components/HomeView.tsx","components/LoginView.tsx","components/ProfileView.tsx","components/AppSettingsItems.tsx","components/AppSettingsView.tsx","router/index.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["LoadingPage","style","height","alignItems","justifyContent","CircularProgress","ErrorPage","children","Error","PickerStep","AUTH_QUERY","gql","GET_USERS_QUERY","GET_SHIFT","GET_USER_SHIFTS","useStyles","makeStyles","theme","container","maxWidth","maxHeight","width","background","userSelect","link","position","textDecoration","cursor","color","fontSize","userDrag","image","objectFit","text","bottom","right","textAlign","fontWeight","letterSpacing","fontFamily","AppLogo","className","to","src","alt","wrapper","margin","flexDirection","breakpoints","down","padding","header","boxShadow","boxSizing","main","zIndex","userButton","display","border","outline","WebkitTapHighlightColor","transition","borderRadius","userBubble","menuContainer","top","content","menuBg","left","menuBox","paddingBottom","menuItem","lineHeight","backgroundColor","marginLeft","AppNav","auth","classes","React","useState","menu","setMenu","closeMenu","handleLogout","localStorage","removeItem","window","location","reload","DropDownMenu","items","user","username","icon","ProfileIcon","SettingsIcon","button","onClick","LogoutIcon","hasAdminPermission","unshift","AppSettingsIcon","map","item","i","key","clsx","Avatar","hostname","avatar","marginRight","firstname","marginTop","months","weekdays","short","long","isToday","date","today","Date","getFullYear","getMonth","getDate","Kind","controlButton","overflow","flex","minHeight","webkitHightLightTapColor","borderRight","borderLeft","minWidth","calendarRow","dayContainer","weekdayItem","DatePicker","current","onSelect","DAY","step","setStep","setDate","incrementDate","t","v","d","MONTH","setMonth","YEAR","setFullYear","handleGo","console","log","HeaderControls","prev","curr","next","toString","substr","s","PickerBody","a","b","elems","startWeekDay","getDay","monthDays","push","elem","l","length","concat","apply","e","slice","forEach","m","day","row","handleSelect","webkitHightlightTapColor","pickerContainer","pickerOutline","DateBar","handleChange","picker","setPicker","go","n","undefined","getKindByDate","getHours","getMinutes","EVENING","MORNING","mainButton","pickerBox","KindBar","kind","open","setOpen","disabled","Check","LOGIN_MUTATION","ADD_ACCOUNT_MUTATION","DELETE_ACCOUNT_MUTATION","UPDATE_ACCOUNT_MUTATION","ADD_RECORD_MUTATION","CLOSE_SHIFT_MUTATION","SIGN_SHIFT_MUTATION","SIGN_RECORD_MUTATION","withZero","getTotalHours","getTime","borderBottom","cell","titleRow","addRecordButton","footer","borderTop","timeSelectContainer","timeSelectTitle","timeSelectItems","timeSelectItem","signRecordButton","useFloatBoxStyles","box","footerItem","footerControls","opacity","AddRecordBox","shift","onSubmit","onCancel","start","end","setHours","state","setState","useMutation","doAddRecord","TimeSelect","target","setMinutes","handleIncrement","error","h","Boolean","variables","input","then","data","catch","err","ShiftTable","loading","addRecordBox","setAddRecordBox","doSignRecord","smallScreen","useMediaQuery","message","getShift","hours","workers","records","rec","perhour","tip","Number","toFixed","deposit","leadZero","handleAddRecordOpen","handleSignRecord","headers","index","value","r","indexOf","lastname","id","discount","sign","signed","status","totals","isInShift","closed","flexWrap","record","ri","Object","keys","hi","opened","RECORD_ADDED_SUBSCRIPTION","marginBottom","closeShiftButton","signShiftButton","CloseShiftButton","boxClasses","setTip","doClose","type","onChange","currentTarget","SignShiftButton","DateTimeString","dateTime","toLocaleString","ShiftView","history","useHistory","params","useParams","useQuery","fetchPolicy","refetch","subscribeToMore","document","updateQuery","subscriptionData","todayKind","needSign","role","needClose","PrivacyCheck","dateURI","HomeView","fields","name","IdIcon","placeholder","PasswordIcon","inputField","inputIcon","borderColor","submitButton","errorMessage","LoginView","active","setActive","password","doLogin","handleFocus","readOnly","isNaN","preventDefault","Lock","token","Login","setItem","autoComplete","field","htmlFor","onBlur","onFocus","Button","variant","size","ShiftList","find","totalHours","discharge","types","includes","ProfileView","shifts","getUserShifts","filter","unsigned","waiting","completion","averageHours","averagePerHour","direction","form","formError","formControls","usersList","overflowY","userCardContainer","userCardAvatar","userCardDetails","searchHeader","noResultsTitle","WebkitAppearance","MozAppearance","textIndent","textOverflow","DeleteUser","onClose","skip","setUser","doDelete","deleteError","setError","users","getUsers","defaultValue","UsersList","filtered","setFiltered","onCompleted","search","setSearch","useEffect","UserCard","results","startsWith","AddAccount","initialState","doAddAccount","success","trim","UpdateAccount","loaded","setLoaded","refetchUsers","account","update","response","changed","doUpdateAccount","blur","idToUpdate","itemHeader","itemContent","AppSettingsView","SettingsItem","title","routes","path","component","requiresAuth","AppRouter","Loading","Authenticate","AuthRoute","route","exact","App","match","API_URI","process","PORT","WS_URI","TOKEN","getItem","httpLink","HttpLink","uri","wsLink","WebSocketLink","options","connectionParams","split","query","definition","getMainDefinition","operation","client","ApolloClient","cache","InMemoryCache","ReactDOM","render","ApolloProvider","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b4e5dbea.chunk.js","sourcesContent":["import React from 'react'\r\nimport { CircularProgress } from '@material-ui/core'\r\n\r\nconst LoadingPage: React.FC = () => {\r\n    return (\r\n        <div style={{ height: '100%', alignItems: 'center', justifyContent: 'center' }}>\r\n            <CircularProgress />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default LoadingPage","import React from 'react'\r\nimport { Error as ErrorIcon } from '@material-ui/icons'\r\n\r\nconst ErrorPage: React.FC<{ children: JSX.Element | JSX.Element[] }> = ({ children }) => {\r\n    return (\r\n        <div style={{ height: '100%', alignItems: 'center', justifyContent: 'center' }}>\r\n            <div style={{ alignItems: 'center', justifyContent: 'center' }}>\r\n                <ErrorIcon />\r\n            </div>\r\n            <div>\r\n                { children }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ErrorPage","import { gql } from \"@apollo/client\";\r\n\r\nexport const AUTH_QUERY = gql`\r\n    {\r\n        Authenticate {\r\n            token \r\n            user {\r\n                id\r\n                firstname\r\n                lastname \r\n                username \r\n                avatar\r\n                role\r\n            }\r\n        }\r\n    }\r\n`\r\n\r\nexport const GET_USERS_QUERY = gql`\r\n    {\r\n        getUsers {\r\n            id\r\n            firstname\r\n            lastname \r\n            username\r\n            avatar\r\n            role\r\n        }\r\n    }\r\n`\r\n\r\nexport const GET_SHIFT = gql`\r\n    query getShift($date: Date) {\r\n        getShift(date: $date) {\r\n            date\r\n            tip\r\n            isInShift\r\n            records {\r\n                start\r\n                end\r\n                user {\r\n                    id\r\n                    firstname\r\n                    lastname\r\n                    avatar\r\n                }\r\n                signed\r\n            }\r\n            status {\r\n                opened\r\n                closed {\r\n                    user {\r\n                        id\r\n                        firstname\r\n                        lastname\r\n                    }\r\n                    date\r\n                }\r\n                signed {\r\n                    user {\r\n                        id \r\n                        firstname\r\n                        lastname\r\n                    }\r\n                    date\r\n                }\r\n            }\r\n        }\r\n    }\r\n`\r\n\r\nexport const GET_USER_SHIFTS = gql`\r\n    {\r\n        getUserShifts {\r\n            date\r\n            tip\r\n            records {\r\n                start \r\n                end \r\n                signed\r\n                user {\r\n                    id\r\n                }\r\n            }\r\n            status {\r\n                opened \r\n                closed {\r\n                    user {\r\n                        firstname\r\n                        lastname \r\n                    }\r\n                    date \r\n                }\r\n                signed {\r\n                    user {\r\n                        firstname \r\n                        lastname \r\n                    }\r\n                    date \r\n                }\r\n            }\r\n        }\r\n    }\r\n`","import React from 'react'\r\nimport { makeStyles, Theme } from '@material-ui/core'\r\nimport clsx from 'clsx'\r\n\r\nexport const months = [ '', '', '', '', '', '', '', '', '', '', '', '' ]\r\n\r\nexport const weekdays = {\r\n    short: [ '', '', '', '', '', '', '' ],\r\n    long: [ '', '', '', '', '', '', '' ]\r\n}\r\n\r\nexport const isToday: ( date: Date ) => boolean = ( date ) => {\r\n    const today = new Date()\r\n    return today.getFullYear() === date.getFullYear() && \r\n        today.getMonth() === date.getMonth() && \r\n        today.getDate() === date.getDate()\r\n}\r\n\r\nexport const isSelectedDate: ( a: Date, b: Date ) => boolean = ( a, b ) => {\r\n    return a.getFullYear() === b.getFullYear() &&\r\n        a.getMonth() === b.getMonth() &&\r\n        a.getDate() === b.getDate() \r\n}\r\n\r\nexport enum PickerStep {\r\n    DAY = 'DAY',\r\n    MONTH = 'MONTH',\r\n    YEAR = 'YEAR'\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {},\r\n    header: {\r\n        flexDirection: 'row',\r\n        height: '40px',\r\n    },\r\n    controlButton: {\r\n        overflow: 'hidden',\r\n        display: 'flex',\r\n        flex: 1,\r\n        padding: '8px 16px',\r\n        boxSizing: 'border-box',\r\n        textAlign: 'center',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '40px',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        webkitHightLightTapColor: 'transparent',\r\n        fontSize: '16px',\r\n        color: '#fff',\r\n        border: 0,\r\n        background: '#6C5549',\r\n        '&.mainButton': {\r\n            flex: 2,\r\n            borderRight: '.5px solid rgba(0,0,0,.3)',\r\n            borderLeft: '.5px solid rgba(255,255,255,.3)',\r\n            minWidth: '200px'\r\n        },\r\n        '&.rightButton': {\r\n            borderRadius: '0 8px 0 0',\r\n            borderLeft: '.5px solid rgba(255,255,255,.3)'\r\n        },\r\n        '&.leftButton': {\r\n            borderRadius: '8px 0 0 0',\r\n            borderRight: '.5px solid rgba(0,0,0,.3)',\r\n        }\r\n    },\r\n    main: {\r\n        background: '#fff',\r\n        flexDirection: 'column',\r\n        border: '1px solid #6C5549',\r\n        boxSizing: 'border-box',\r\n        minHeight: '270px',\r\n        borderRadius: '0 0 8px 8px',\r\n        overflow: 'hidden',\r\n        '& button': {\r\n            display: 'flex',\r\n            flex: 1,\r\n            minHeight: '40px',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            border: 0,\r\n            background: 0,\r\n            outline: 'none',\r\n            cursor: 'pointer',\r\n        }\r\n    },\r\n    calendarRow: {\r\n        flex: 1,\r\n    },\r\n    dayContainer: {\r\n        '& button': {\r\n            '& div': {\r\n                borderRadius: '50%',\r\n                width: '25px',\r\n                height: '25px',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                textAlign: 'center'\r\n            },\r\n            '& div.today': {\r\n                background: '#c4bbb6',\r\n                color: '#6C5549',\r\n                fontWeight: 500\r\n            },\r\n            '& div.selected': {\r\n                background: '#C1E0F7',\r\n                color: '#333',\r\n                fontWeight: 500\r\n            },\r\n            '&:hover': {\r\n                '& div': {\r\n                    background: '#6C5549',\r\n                    color: '#fff',\r\n                }\r\n            }\r\n        },\r\n    },\r\n    weekdayItem: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '30px',\r\n        color: '#bbb',\r\n        fontWeight: 500,\r\n        fontSize: '12px',\r\n    }\r\n}))\r\n\r\nconst DatePicker: React.FC<{ current?: Date, onSelect?: (d: Date) => void }> = ({ current = new Date(), onSelect }) => {\r\n    const classes = useStyles()\r\n    const [ step, setStep ] = React.useState<PickerStep>(PickerStep.DAY)\r\n    const [ date, setDate ] = React.useState<Date>(current)\r\n\r\n    const incrementDate = (t: PickerStep, v: number = 1) => {\r\n        let d = new Date(date)\r\n        if (t === PickerStep.DAY) {\r\n            return new Date(d.setDate(d.getDate() + v))\r\n        }\r\n        if (t === PickerStep.MONTH) {\r\n            return new Date(d.setMonth(d.getMonth() + v))\r\n        }\r\n        if (t === PickerStep.YEAR) {\r\n            return new Date(d.setFullYear(d.getFullYear() + v))\r\n        }\r\n        return d\r\n    }\r\n\r\n    const handleGo = (d: Date) => {\r\n        console.log('clicked date', d)\r\n        setDate(d)\r\n    }\r\n\r\n    const handleSelect = (d: Date) => {\r\n        if (step === PickerStep.DAY) {\r\n            return onSelect?.(d)\r\n        }\r\n        if (step === PickerStep.MONTH) {\r\n            setStep(PickerStep.DAY)\r\n        }\r\n        if (step === PickerStep.YEAR) {\r\n            setStep(PickerStep.MONTH)\r\n        }\r\n        setDate(d)\r\n    }\r\n\r\n    const HeaderControls: React.FC = () => {\r\n        let prev = { text: '', date }, curr = { text: '', date }, next = { text: '', date }\r\n        if (step === PickerStep.DAY) {\r\n            prev = { text: months[incrementDate(PickerStep.MONTH, -1).getMonth()], date: incrementDate(PickerStep.MONTH, -1) }\r\n            curr = { text: months[new Date(date).getMonth()], date }\r\n            next = { text: months[incrementDate(PickerStep.MONTH).getMonth()], date: incrementDate(PickerStep.MONTH) }\r\n        }\r\n        if (step === PickerStep.MONTH) {\r\n            prev = { text: incrementDate(PickerStep.YEAR, -1).getFullYear().toString(), date: incrementDate(PickerStep.YEAR, -1) }\r\n            curr = { text: new Date(date).getFullYear().toString(), date }\r\n            next = { text: incrementDate(PickerStep.YEAR).getFullYear().toString(), date: incrementDate(PickerStep.YEAR) }\r\n        }\r\n        if (step === PickerStep.YEAR) {\r\n            prev = { text: incrementDate(PickerStep.YEAR, -5).getFullYear().toString(), date: incrementDate(PickerStep.YEAR, -5) }\r\n            curr = { text: `${(new Date(date).getFullYear() - 4).toString()}-${(new Date(date).getFullYear() + 4).toString()}`, date }\r\n            next = { text: incrementDate(PickerStep.YEAR, 5).getFullYear().toString(), date: incrementDate(PickerStep.YEAR, 5) }\r\n        }\r\n\r\n        const handleStepChange = () => {\r\n            let s = PickerStep.DAY\r\n            if (step === PickerStep.DAY) s = PickerStep.MONTH\r\n            if (step === PickerStep.MONTH) s = PickerStep.YEAR\r\n            if (step === PickerStep.YEAR) return\r\n            return setStep(s)\r\n        }\r\n\r\n        return (\r\n            <header className={classes.header}>\r\n                <button className={clsx(classes.controlButton, 'rightButton')} onClick={() => handleGo(prev.date)}>{ step === PickerStep.DAY ? prev.text.substr(0,3) : prev.text }</button>\r\n                <button className={clsx(classes.controlButton, 'mainButton')} onClick={handleStepChange}>{ curr.text }</button>\r\n                <button className={clsx(classes.controlButton, 'leftButton')} onClick={() => handleGo(next.date)}>{ step === PickerStep.DAY ? next.text.substr(0,3) : next.text }</button>\r\n            </header>\r\n        )\r\n    }\r\n\r\n    const PickerBody: React.FC = () => {\r\n        let elems: any = []\r\n        const d = new Date(date)\r\n        if (step === PickerStep.DAY) {\r\n            const startWeekDay = new Date(d.setDate(1)).getDay()\r\n            const monthDays = new Date(d.getFullYear(), d.getMonth() + 1, 0).getDate()\r\n            \r\n            for (let i = startWeekDay-1; i >= 0; i--) {\r\n                elems.push({ elem: <div className=\"prevMonth\" key={`prev_month_${i}`}>{ monthDays-i }</div>, date: new Date(d.getFullYear(), d.getMonth() - 1, monthDays-i) })\r\n            }\r\n            for (let i = 1; i <= monthDays; i++) {\r\n                elems.push({ elem: <div className={clsx(isToday(new Date(d.setDate(i))) && 'today', isSelectedDate(new Date(current), new Date(d.setDate(i))) && 'selected')} key={`curr_month_${i}`}>{i}</div>, date: new Date(d.setDate(i)) })\r\n            }\r\n            const l = 42 - elems.length\r\n            for (let i = 1; i <= l; i++) {\r\n                elems.push({ elem: <div className=\"nextMonth\" key={`next_month_${i}`}>{i}</div>, date: new Date(d.getFullYear(), d.getMonth() + 1, i) })\r\n            }\r\n\r\n            elems = elems.concat.apply([], \r\n                elems.map((e: any, i: number) => {\r\n                    return i % 7 ? [] : [ elems.slice(i, i+7) ]\r\n                })    \r\n            )\r\n        }\r\n\r\n        if (step === PickerStep.MONTH) {\r\n            months.forEach((m: string, i: number) => {\r\n                elems.push({ elem: <div key={`month_${i}`}>{ months[i] }</div>, date: d.setMonth(i) })\r\n            })\r\n\r\n            elems = elems.concat.apply([], \r\n                elems.map((e: any, i: number) => {\r\n                    return i % 3 ? [] : [ elems.slice(i, i+3) ]\r\n                })    \r\n            )\r\n        }\r\n\r\n        if (step === PickerStep.YEAR) {\r\n            for (let i = d.getFullYear() - 4; i < (d.getFullYear() + 5); i++) {\r\n                elems.push({ elem: <div key={`year_${i}`}>{ i }</div>, date: new Date(i, d.getMonth(), d.getDate()) })\r\n            }\r\n\r\n            elems = elems.concat.apply([], \r\n                elems.map((e: any, i: number) => {\r\n                    return i % 3 ? [] : [ elems.slice(i, i+3) ]\r\n                })    \r\n            )\r\n        }\r\n\r\n        return (\r\n            <main className={clsx(classes.main, step === PickerStep.DAY && classes.dayContainer )}>\r\n                {\r\n                    step === PickerStep.DAY &&\r\n                    <div style={{flexDirection: 'row'}}>\r\n                        {\r\n                            weekdays.short.map((day: string, i: number) => (\r\n                                <div className={classes.weekdayItem} key={i}>{ day }</div>\r\n                            ))\r\n                        }\r\n                    </div>\r\n                }\r\n                { \r\n                    elems.map((row: any, i: number) => (\r\n                        <div className={classes.calendarRow} key={i} style={{flexDirection: 'row'}}>\r\n                            {\r\n                                row.map((item: any, i: number) => (\r\n                                    <button onClick={e => handleSelect(item.date)} key={i}>{ item.elem }</button>\r\n                                ))\r\n                            }\r\n                        </div>\r\n                    ))\r\n                }\r\n            </main>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <HeaderControls />\r\n            <PickerBody />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default DatePicker","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { makeStyles, Theme } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        maxWidth: '205px',\r\n        maxHeight: '69px',\r\n        width: '100%',\r\n        height: '100%',\r\n        background: '#fff',\r\n        userSelect: 'none',\r\n    },\r\n    link: {\r\n        position: 'relative',\r\n        textDecoration: 'none',\r\n        cursor: 'pointer',\r\n        color: '#6c5549',\r\n        fontSize: '2vh',\r\n        userDrag: 'none'\r\n    },\r\n    image: {\r\n        width: '100%',\r\n        height: '100%',\r\n        objectFit: 'contain',\r\n        userDrag: 'none',\r\n    },\r\n    text: {\r\n        position: 'absolute',\r\n        bottom: '-.2vh',\r\n        width: '67%',\r\n        height: '20px',\r\n        right: '16%',\r\n        background: '#fff',\r\n        textAlign: 'center',\r\n        fontWeight: 700,\r\n        letterSpacing: '.08rem',\r\n        userDrag: 'none',\r\n        fontFamily: 'Tahoma'\r\n    }\r\n}))\r\n\r\nconst AppLogo: React.FC = () => {\r\n    const { container, link, image, text } = useStyles()\r\n    return (\r\n        <div className={container}>\r\n            <Link to=\"/\" className={link}>\r\n                <img className={image} src=\"/gordo-logo.png\" alt=\"\" />\r\n                <span className={text}> </span>\r\n            </Link>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AppLogo","import React from 'react'\r\nimport { IAuth, hasAdminPermission } from '../router'\r\nimport { Avatar, makeStyles, Theme } from '@material-ui/core'\r\nimport { Link } from 'react-router-dom'\r\nimport {\r\n    ArrowDropDownRounded as ArrowDownIcon,\r\n    ArrowDropUpRounded as ArrowUpIcon,\r\n    PersonRounded as ProfileIcon,\r\n    ExitToAppRounded as LogoutIcon,\r\n    Settings as SettingsIcon,\r\n    SettingsApplicationsRounded as AppSettingsIcon\r\n} from '@material-ui/icons'\r\nimport AppLogo from './AppLogo'\r\nimport clsx from 'clsx'\r\nimport { OverridableComponent } from '@material-ui/core/OverridableComponent'\r\n\r\ninterface MenuItem {\r\n    text: string\r\n    icon: OverridableComponent<any>\r\n    link?: string\r\n    button?: {\r\n        onClick: () => void\r\n    },\r\n    color?: 'red'\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        height: '100%',\r\n    },\r\n    wrapper: {\r\n        maxWidth: '980px',\r\n        width: '100%',\r\n        margin: '0 auto',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        [theme.breakpoints.down(1020)]: {\r\n            padding: '0 20px',\r\n            margin: 0,\r\n        }\r\n    },\r\n    header: {\r\n        height: '70px',\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        background: '#fff',\r\n        boxShadow: '0 1px 2px rgba(0,0,0,.1)',\r\n        boxSizing: 'border-box',\r\n    },\r\n    main: {\r\n        position: 'relative',\r\n        zIndex: 1000,\r\n        maxWidth: '980px',\r\n        width: '100%',\r\n        height: 'calc(100% - 70px)',\r\n        boxSizing: 'border-box',\r\n        margin: '0 auto',\r\n        flexDirection: 'row',\r\n        [theme.breakpoints.down(1020)]: {\r\n            padding: '0 20px',\r\n            margin: 0,\r\n        }\r\n    },\r\n    userButton: {\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        boxSizing: 'border-box',\r\n        padding: '4px 8px',\r\n        border: 0,\r\n        background: 0,\r\n        outline: 'none',\r\n        userSelect: 'none',\r\n        userDrag: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        fontSize: '16px',\r\n        fontWeight: 500,\r\n        width: '130px',\r\n        transition: 'width 0.1s ease-in-out',\r\n        '&.active': {\r\n            width: '200px',\r\n            justifyContent: 'space-between',\r\n            borderRadius: '10px 10px 0 0',\r\n            boxShadow: '0 0px 3px rgba(0,0,0,.3)'\r\n        }\r\n    },\r\n    userBubble: {\r\n        position: 'relative'\r\n    },\r\n    menuContainer: {\r\n        position: 'absolute',\r\n        zIndex: 1101,\r\n        top: '100%',\r\n        width: '100%',\r\n        background: '#fff',\r\n        boxShadow: '0 0 3px rgba(0,0,0,.3)',\r\n        borderRadius: '0 0 10px 10px',\r\n        '&::before': {\r\n            content: '\"\"',\r\n            position: 'absolute',\r\n            top: '-3px',\r\n            width: '100%',\r\n            height: '3px',\r\n            background: '#fff'\r\n        },\r\n    },\r\n    menuBg: {\r\n        position: 'fixed',\r\n        width: '100%',\r\n        height: '100%',\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: 1100\r\n    },\r\n    menuBox: {\r\n        zIndex: 1101,\r\n        paddingBottom: '10px',\r\n        boxSizing: 'border-box'\r\n    },\r\n    menuItem: {\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        cursor: 'pointer',\r\n        background: 0,\r\n        border: 0,\r\n        padding: '6px 12px',\r\n        boxSizing: 'border-box',\r\n        textDecoration: 'none',\r\n        userSelect: 'none',\r\n        userDrag: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        outline: 'none',\r\n        fontWeight: 500,\r\n        fontSize: '14px',\r\n        lineHeight: '30px',\r\n        color: '#333',\r\n        '&:hover': {\r\n            backgroundColor: 'rgba(0,0,0,.0425)',\r\n            color: '#0089c0'\r\n        },\r\n        '& div.icon': {\r\n            marginLeft: '10px',\r\n            height: '40px',\r\n            width: '35px',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n        },\r\n        '&.primaryButton': {\r\n            color: '#f44336'\r\n        }\r\n    }\r\n}))\r\n\r\nconst AppNav: React.FC<{ children: JSX.Element | JSX.Element[], auth: IAuth }> = ({ children, auth }) => {\r\n    const classes = useStyles()\r\n    const [ menu, setMenu ] = React.useState<boolean>(false)\r\n\r\n    const openMenu = () => setMenu(true)\r\n    const closeMenu = () => setMenu(false)\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem('token')\r\n        window.location.reload()\r\n    }\r\n\r\n    const DropDownMenu: React.FC = () => {\r\n        const items: MenuItem[] = [\r\n            {\r\n                text: '',\r\n                link: `/p/${auth.user.username}`,\r\n                icon: ProfileIcon\r\n            },\r\n            {\r\n                text: '',\r\n                link: '/account/settings',\r\n                icon: SettingsIcon\r\n            },\r\n            {\r\n                text: '',\r\n                button: {\r\n                    onClick: handleLogout\r\n                },\r\n                icon: LogoutIcon,\r\n                color: 'red'\r\n            }\r\n        ]\r\n\r\n        if (hasAdminPermission(auth)) {\r\n            items.unshift({\r\n                text: ' ',\r\n                link: '/app/settings',\r\n                icon: AppSettingsIcon,\r\n                color: 'red'\r\n            })\r\n        }\r\n\r\n        return (\r\n            <div className={classes.menuContainer}>\r\n                <div className={classes.menuBg} onClick={closeMenu} />\r\n                <div className={classes.menuBox}>\r\n                    {\r\n                        items.map((item: MenuItem, i: number) => {\r\n                            return (\r\n                                <div key={i}>\r\n                                    {\r\n                                        item.link &&\r\n                                        <Link key={i} className={classes.menuItem} to={item.link}>\r\n                                            <div className=\"icon\">\r\n                                                <item.icon />\r\n                                            </div>\r\n                                            { item.text }\r\n                                        </Link>\r\n                                    }\r\n                                    {\r\n                                        item.button &&\r\n                                        <button className={clsx(classes.menuItem, item.color && 'primaryButton')} onClick={item.button.onClick}>\r\n                                            <div className=\"icon\">\r\n                                                <item.icon />\r\n                                            </div>\r\n                                            { item.text }\r\n                                        </button>\r\n                                    }\r\n                                </div>\r\n                            )\r\n                        })\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <header className={classes.header}>\r\n                <div className={classes.wrapper}>\r\n                    <div style={{ maxWidth: '150px'}}>\r\n                        <AppLogo />\r\n                    </div>\r\n                    <div className={classes.userBubble}>\r\n                        <button className={clsx(classes.userButton, menu && 'active')} onClick={menu ? closeMenu : openMenu}>\r\n                            <div style={{ flexDirection: 'row', alignItems: 'center' }}>\r\n                                <div>\r\n                                    <Avatar src={`http://${window.location.hostname}:4000${auth.user.avatar}`} />\r\n                                </div>\r\n                                <div style={{ marginRight: '10px' }}>\r\n                                    { auth.user.firstname }\r\n                                </div>\r\n                            </div>\r\n                            <div style={{ alignItems: 'center', justifyContent: 'center', height: '40px', marginTop: '2px' }}>\r\n                                {\r\n                                    menu \r\n                                    ? <ArrowUpIcon />\r\n                                    : <ArrowDownIcon />\r\n                                }\r\n                            </div>\r\n                        </button>\r\n                        {\r\n                            menu && <DropDownMenu />\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </header>\r\n            <main className={classes.main}>\r\n                <div style={{ width: '100%' }}>\r\n                    { children }\r\n                </div>\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AppNav","import React from 'react'\r\nimport { makeStyles, Theme } from '@material-ui/core'\r\nimport { \r\n    Check as CheckIcon,\r\n    WbSunny as SunIcon,\r\n    NightsStay as MoonIcon\r\n} from '@material-ui/icons'\r\nimport clsx from 'clsx'\r\n\r\nexport enum Kind {\r\n    MORNING = '',\r\n    EVENING = '',\r\n}\r\n\r\nexport const getKindByDate: ( date?: Date ) => Kind = ( date: Date = new Date() ) => {\r\n    return date.getHours() + ( date.getMinutes() / 60 ) >= 16 ? Kind.EVENING : Kind.MORNING\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        position: 'relative',\r\n    },\r\n    mainButton: {\r\n        display: 'flex',\r\n        overflow: 'hidden',\r\n        flex: 1,\r\n        padding: '8px 16px',\r\n        boxSizing: 'border-box',\r\n        textAlign: 'center',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '40px',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        webkitHightlightTapColor: 'transparent',\r\n        fontSize: '16px',\r\n        color: '#fff',\r\n        border: 0,\r\n        borderRadius: '8px',\r\n        background: '#6C5549',\r\n        '&.opened': {\r\n            borderRadius: '8px 8px 0 0'\r\n        },\r\n        '& span.text': {\r\n            marginLeft: '8px'\r\n        }\r\n    },\r\n    pickerContainer: {\r\n        position: 'absolute',\r\n        top: '40px',\r\n        width: '100%',\r\n    },\r\n    pickerOutline: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        zIndex: 1499,\r\n    },\r\n    pickerBox: {\r\n        background: '#fff',\r\n        border: '1px solid #6C5549',\r\n        boxSizing: 'border-box',\r\n        zIndex: 1500,\r\n        borderRadius: '0 0 8px 8px',\r\n        overflow: 'hidden',\r\n        '& button': {\r\n            display: 'flex',\r\n            overflow: 'hidden',\r\n            flex: 1,\r\n            boxSizing: 'border-box',\r\n            textAlign: 'center',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            minHeight: '40px',\r\n            cursor: 'pointer',\r\n            outline: 'none',\r\n            fontSize: '16px',\r\n            color: '#333',\r\n            border: 0,\r\n            background: 0,\r\n            '& span.text': {\r\n                marginLeft: '.3rem'\r\n            },\r\n            '&:hover': {\r\n                background: '#eee'\r\n            },\r\n            '&:disabled': {\r\n                fontWeight: 500,\r\n                color: '#333',\r\n            }\r\n        }\r\n    }\r\n}))\r\n\r\nconst KindBar: React.FC<{ kind?: Kind, handleChange: (kind: Kind) => void }> = ({ kind = getKindByDate(new Date()), handleChange }) => {\r\n    const classes = useStyles()\r\n    const [ open, setOpen ] = React.useState<boolean>(false)\r\n\r\n    const onSelect = (kind: Kind) => {\r\n        setOpen(false)\r\n        return handleChange(kind)\r\n    }\r\n    return (\r\n        <div className={classes.container}>\r\n            <button className={clsx(classes.mainButton, open && 'opened')} onClick={e => setOpen(true)}>\r\n                <span className=\"text\">{ kind }</span>\r\n                {\r\n                    kind === Kind.MORNING \r\n                    ? <SunIcon />\r\n                    : <MoonIcon />\r\n                }\r\n            </button>\r\n            {\r\n                open &&\r\n                <div className={classes.pickerContainer}>\r\n                    <div className={classes.pickerOutline} onClick={e => setOpen(false)} />\r\n                    <div className={classes.pickerBox}>\r\n                        <button disabled={kind === Kind.MORNING} onClick={e => onSelect(Kind.MORNING)}>\r\n                            <span className=\"text\">{ Kind.MORNING }</span>\r\n                            { \r\n                                kind === Kind.MORNING &&\r\n                                <CheckIcon />\r\n                            }\r\n                        </button>\r\n                        <button disabled={kind === Kind.EVENING} onClick={e => onSelect(Kind.EVENING)}>\r\n                            <span className=\"text\">{ Kind.EVENING }</span>\r\n                            { \r\n                                kind === Kind.EVENING &&\r\n                                <CheckIcon />\r\n                            }\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default KindBar","import React from 'react'\r\nimport DatePicker, { months } from './Datepicker'\r\nimport { makeStyles, Theme } from '@material-ui/core'\r\nimport clsx from 'clsx'\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        flexDirection: 'row',\r\n        position: 'relative',\r\n        maxHeight: '40px',\r\n        [theme.breakpoints.down(480)]: {\r\n            width: '100%',\r\n        }\r\n    },\r\n    controlButton: {\r\n        display: 'flex',\r\n        overflow: 'hidden',\r\n        flex: 1,\r\n        padding: '8px 16px',\r\n        boxSizing: 'border-box',\r\n        textAlign: 'center',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '40px',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        webkitHightlightTapColor: 'transparent',\r\n        fontSize: '16px',\r\n        color: '#fff',\r\n        border: 0,\r\n        background: '#6C5549',\r\n        '&.mainButton': {\r\n            flex: 2,\r\n            borderRight: '.5px solid rgba(0,0,0,.3)',\r\n            borderLeft: '.5px solid rgba(255,255,255,.3)',\r\n            minWidth: '200px'\r\n        },\r\n        '&.rightButton': {\r\n            borderRadius: '0 8px 8px 0',\r\n            borderLeft: '.5px solid rgba(255,255,255,.3)'\r\n        },\r\n        '&.leftButton': {\r\n            borderRadius: '8px 0 0 8px',\r\n            borderRight: '.5px solid rgba(0,0,0,.3)',\r\n        }\r\n    },\r\n    pickerContainer: {\r\n        position: 'absolute',\r\n        zIndex: 1500,\r\n        width: '100%',\r\n        top: 0,\r\n    },\r\n    pickerOutline: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n    }\r\n}))\r\n\r\nconst DateBar: React.FC<{ date?: Date, handleChange: (date: Date) => void }> = ({ date = new Date(), handleChange }) => {\r\n    const classes = useStyles()\r\n    const [ picker, setPicker ] = React.useState<Date | undefined>()\r\n    const go: (n?: number) => void = (n = 1) => {\r\n        const d = new Date(date)\r\n\r\n        return handleChange(new Date(d.setDate(d.getDate() + n)))\r\n    }\r\n\r\n    const handleDatePickerSelect = ( d: Date ) => {\r\n        console.log('picker selected', d)\r\n        setPicker(undefined)\r\n        return handleChange(d)\r\n    }\r\n    \r\n    return (\r\n        <section className={classes.container}>\r\n            {\r\n                picker && \r\n                <div className={classes.pickerContainer}>\r\n                    <div className={classes.pickerOutline} onClick={e => setPicker(undefined)} />\r\n                    <DatePicker current={picker} onSelect={handleDatePickerSelect} />\r\n                </div>\r\n            }\r\n            <button className={clsx(classes.controlButton, 'rightButton')} onClick={() => go(-1)}></button>\r\n            <button className={clsx(classes.controlButton, 'mainButton')} onClick={() => setPicker(date)}>{ date.getDate() } { months[date.getMonth()] }, { date.getFullYear() }</button>\r\n            <button className={clsx(classes.controlButton, 'leftButton')} onClick={() => go()}></button>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default DateBar","import { gql } from \"@apollo/client\";\r\n\r\nexport const LOGIN_MUTATION = gql`\r\n    mutation Login($input: JSON) {\r\n        Login(input: $input) {\r\n            token\r\n        }\r\n    }\r\n`\r\n\r\nexport const ADD_ACCOUNT_MUTATION = gql`\r\n    mutation AddAccount($input: JSON) {\r\n        AddAccount(input: $input)\r\n    }\r\n`\r\n\r\nexport const DELETE_ACCOUNT_MUTATION = gql`\r\n    mutation DeleteAccount($id: String) {\r\n        DeleteAccount(id: $id)\r\n    }\r\n`\r\n\r\nexport const UPDATE_ACCOUNT_MUTATION = gql`\r\n    mutation UpdateAccount($input: JSON) {\r\n        UpdateAccount(input: $input)\r\n    }\r\n`\r\n\r\nexport const ADD_RECORD_MUTATION = gql`\r\n    mutation AddRecord($input: JSON) {\r\n        AddRecord(input: $input) {\r\n            start\r\n            end\r\n            user {\r\n                id\r\n                firstname\r\n            }\r\n        }\r\n    }\r\n`\r\n\r\nexport const CLOSE_SHIFT_MUTATION = gql`\r\n    mutation CloseShift($input: JSON) {\r\n        CloseShift(input: $input) \r\n    }\r\n`\r\n\r\nexport const SIGN_SHIFT_MUTATION = gql`\r\n    mutation SignShift($input: JSON) {\r\n        SignShift(input: $input)\r\n    }\r\n`\r\n\r\nexport const SIGN_RECORD_MUTATION = gql`\r\n    mutation SignRecord($input: JSON) {\r\n        SignRecord(input: $input)\r\n    }\r\n`","import React, { Fragment } from 'react'\r\nimport { useMediaQuery, makeStyles, Theme } from '@material-ui/core'\r\nimport { Kind, getKindByDate } from './KindBar'\r\nimport { months } from './Datepicker'\r\nimport { ADD_RECORD_MUTATION, SIGN_RECORD_MUTATION } from '../apollo/mutation'\r\nimport { useMutation } from '@apollo/client'\r\nimport { IAuth } from '../router'\r\n\r\ninterface AddRecordState {\r\n    date: Date\r\n    kind: Kind\r\n    start: Date\r\n    end: Date\r\n    [key: string]: Kind | Date\r\n}\r\n\r\nexport const withZero: (v: number) => string = (v: number) => v < 10 ? `0${v}` : v.toString()\r\n\r\nconst getTotalHours: (a: Date, b: Date) => number = (a: Date, b: Date) => {\r\n    return (b.getTime() - a.getTime()) / 1000 / 60 / 60\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        position: 'relative',\r\n        flex: 1,\r\n        flexDirection: 'column'\r\n    },\r\n    header: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        lineHeight: '40px',\r\n        fontSize: '14px',\r\n        fontWeight: 500,\r\n        background: '#eee',\r\n        borderRadius: '8px 8px 0 0',\r\n        '& div': {\r\n            flex: 1,\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            boxSizing: 'border-box',\r\n            '&:first-child': {\r\n                padding: '0 10px',\r\n            }\r\n        },\r\n        border: '.5px solid #ebebeb',\r\n        borderBottom: 0,\r\n    },\r\n    main: {},\r\n    row: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        lineHeight: '40px',\r\n        '&:nth-child(even)': {\r\n            background: '#efefef',\r\n        },\r\n        border: '.5px solid #ebebeb',\r\n        borderBottom: 0,\r\n    },\r\n    cell: {\r\n        flex: 1,\r\n        boxSizing: 'border-box',\r\n        '&:first-child': {\r\n            padding: '0 10px',\r\n        }\r\n    },\r\n    titleRow: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        lineHeight: '40px',\r\n        color: '#aaa',\r\n        boxSizing: 'border-box'\r\n    },\r\n    addRecordButton: {\r\n        margin: '10px auto',\r\n        background: '#4caf50',\r\n        border: 0,\r\n        color: '#fff',\r\n        fontWeight: 500,\r\n        padding: '6px 20px',\r\n        borderRadius: '8px',\r\n        letterSpacing: '.1rem',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transparent'\r\n    },\r\n    footer: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        borderRadius: '0 0 8px 8px',\r\n        border: '.5px solid #ebebeb',\r\n        borderTop: 0,\r\n    },\r\n    item: {\r\n        flex: 1,\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        color: '#0089c0',\r\n        fontWeight: 500,\r\n        padding: '5px 0',\r\n        boxSizing: 'border-box',\r\n        '& span': {\r\n            color: '#333',\r\n            fontSize: '14px',\r\n        }\r\n    },\r\n    timeSelectContainer: {\r\n        minWidth: '100px',\r\n        alignItems: 'center',\r\n        justifyContent: 'center'\r\n    },\r\n    timeSelectTitle: {\r\n        fontSize: '14px',\r\n        fontWeight: 500,\r\n        color: '#333',\r\n        marginTop: '10px'\r\n    },\r\n    timeSelectItems: {\r\n    },\r\n    timeSelectItem: {\r\n        margin: '10px 0',\r\n        '& button': {\r\n            border: 0,\r\n            background: 0,\r\n            fontSize: '12px',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            cursor: 'pointer',\r\n            outline: 'none',\r\n            margin: '10px 0',\r\n            WebkitTapHighlightColor: 'transparent',\r\n            color: '#999',\r\n            boxSizing: 'border-box',\r\n            [theme.breakpoints.down(480)]: {\r\n                fontSize: '22px',\r\n                padding: '10px',\r\n            }\r\n        },\r\n        '& div': {\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            fontSize: '16px',\r\n            fontWeight: 500,\r\n            margin: '5px 0',\r\n            [theme.breakpoints.down(480)]: {\r\n                fontSize: '28px',\r\n            }\r\n        }\r\n    },\r\n    signRecordButton: {\r\n        border: 0,\r\n        display: 'flex',\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        background: '#4caf50',\r\n        fontWeight: 500,\r\n        color: '#fff',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        margin: '5px 0',\r\n        borderRadius: '8px',\r\n    },\r\n}))\r\n\r\nexport const useFloatBoxStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    outline: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        zIndex: 1500,\r\n        background: 'rgba(0,0,0,.8)'\r\n    },\r\n    box: {\r\n        background: '#fff',\r\n        zIndex: 1501,\r\n        borderRadius: '8px',\r\n        outline: 'none',\r\n        overflow: 'hidden',\r\n        minWidth: '300px',\r\n        [theme.breakpoints.down(480)]: {\r\n            width: '90%',\r\n        }\r\n    },\r\n    header: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n        lineHeight: '40px',\r\n        fontSize: '14px',\r\n        fontWeight: 500,\r\n        padding: '4px 12px',\r\n        boxSizing: 'border-box',\r\n        background: '#6c5549',\r\n        color: '#fff',\r\n    },\r\n    main: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center'\r\n    },\r\n    footer: {},\r\n    footerItem: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '20px',\r\n        '& span': {\r\n            marginLeft: '.3rem',\r\n            fontWeight: 500,\r\n        }\r\n    },\r\n    footerControls: {\r\n        margin: '10px 12px',\r\n        justifyContent: 'flex-end',\r\n        '& button': {\r\n            fontWeight: 500,\r\n            color: '#fff',\r\n            border: 0,\r\n            marginRight: '10px',\r\n            cursor: 'pointer',\r\n            outline: 'none',\r\n            WebkitTapHighlightColor: 'transparent',\r\n            padding: '4px 12px',\r\n            boxSizing: 'border-box',\r\n            borderRadius: '8px',\r\n        },\r\n        '& button.confirmButton': {\r\n            background: '#4caf50',\r\n            '&:disabled': {\r\n                opacity: .3\r\n            }\r\n        },\r\n        '& button.cancelButton': {\r\n            background: '#f44336',\r\n        }\r\n    }\r\n}))\r\n\r\nconst AddRecordBox: React.FC<{ shift: { kind: Kind, date: Date }, onSubmit?: () => void, onCancel?: () => void }> = ({ shift, onSubmit, onCancel }) => {\r\n    const classes = useFloatBoxStyles()\r\n    const [ state, setState ] = React.useState<AddRecordState>({\r\n        date: new Date(shift.date),\r\n        kind: shift.kind,\r\n        start: new Date(shift.date),\r\n        end: new Date(shift.date.setHours(shift.date.getHours() + 1))\r\n    })\r\n\r\n    const [ doAddRecord ] = useMutation(ADD_RECORD_MUTATION)\r\n\r\n    const TimeSelect: React.FC<{ target: 'start' | 'end' }> = ({ target }) => {\r\n        const classes = useStyles()\r\n        const he = { start: '', end: '' }\r\n\r\n        const incrementDate: (d: Date, t: 'h' | 'm', v?: number) => Date = (d, t, v = 1) => {\r\n            d = new Date(d)\r\n            if (t === 'm') return new Date(d.setMinutes(d.getMinutes() + (v * 15))) \r\n            return new Date(d.setHours(d.getHours() + v))\r\n        }\r\n\r\n        const handleIncrement = ( d: Date ) => {\r\n            setState({ ...state, [target]: d })\r\n        }\r\n\r\n        return (\r\n            <div className={classes.timeSelectContainer}>\r\n                <h4 className={classes.timeSelectTitle}>{ he[target] }</h4>\r\n                <div className={classes.timeSelectItems} style={{ flexDirection: 'row-reverse', alignItems: 'center' }}>\r\n                    <div className={classes.timeSelectItem}>\r\n                        <button onClick={e => handleIncrement(incrementDate(state[target], 'h', -1)) }>{ withZero(incrementDate(state[target], 'h', -1).getHours()) }</button>\r\n                        <div>{ withZero(state[target].getHours()) }</div>\r\n                        <button onClick={e => handleIncrement(incrementDate(state[target], 'h')) }>{ withZero(incrementDate(state[target], 'h').getHours()) }</button>\r\n                    </div>\r\n                    <span>:</span>\r\n                    <div className={classes.timeSelectItem}>\r\n                        <button onClick={e => handleIncrement(incrementDate(state[target], 'm', -1)) }>{ withZero(incrementDate(state[target], 'm', -1).getMinutes()) }</button>\r\n                        <div>{ withZero(state[target].getMinutes()) }</div>\r\n                        <button onClick={e => handleIncrement(incrementDate(state[target], 'm')) }>{ withZero(incrementDate(state[target], 'm').getMinutes()) }</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    \r\n    const handleSubmit = () => {\r\n        doAddRecord({\r\n            variables: {\r\n                input: state\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            onSubmit?.()\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    let error = ''\r\n    let h = getTotalHours(state.start,state.end)\r\n    if (h === 0) error = '    '\r\n    if (h < 0) error = '     '\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <div onClick={e => onCancel?.()} className={classes.outline}></div>\r\n            <div className={classes.box}>\r\n                <header className={classes.header}>\r\n                    <h3> </h3>\r\n                    <span>\r\n                        { state.date.getDate() } { months[ state.date.getMonth() ]}, { state.date.getFullYear() }, { getKindByDate(state.date) }\r\n                    </span>\r\n                </header>\r\n                <main className={classes.main} style={{ flexDirection: 'row', alignItems: 'flex-start' }}>\r\n                    <TimeSelect target=\"start\" />\r\n                    <TimeSelect target=\"end\" />\r\n                </main>\r\n                <footer className={classes.footer}>\r\n                    <h4 className={classes.footerItem}>\r\n                        <span>\" :</span> { getTotalHours(state.start, state.end) }\r\n                    </h4>\r\n                    <div style={{ color: 'red'}} className={classes.footerItem}>{ error }</div>\r\n                    <div className={classes.footerControls} style={{ flexDirection: 'row' }}>\r\n                        <button className=\"confirmButton\" disabled={Boolean(error)} onClick={handleSubmit}></button>\r\n                        <button className=\"cancelButton\" onClick={e => onCancel?.() }></button>\r\n                    </div>\r\n                </footer>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst ShiftTable: React.FC<{ auth: IAuth, loading: boolean, error: any, data: any }> = ({ auth, loading, error, data }) => {\r\n    const classes = useStyles()\r\n    const [ addRecordBox, setAddRecordBox ] = React.useState<{ kind: Kind, date: Date } | undefined>()\r\n    const [ doSignRecord] = useMutation(SIGN_RECORD_MUTATION)\r\n    const smallScreen = useMediaQuery('(max-width: 768px)')\r\n    if (loading) return <div>loading</div>\r\n\r\n    if (error) return <div>{ error.message }</div>\r\n\r\n    const { getShift: shift } = data || {}\r\n\r\n    if (shift) {\r\n        shift.hours = 0\r\n        shift.workers = 0\r\n        shift.records.forEach((rec: any) => {\r\n            rec.start = new Date(rec.start)\r\n            rec.end = new Date(rec.end)\r\n            rec.hours = (rec.end.getTime() - rec.start.getTime()) / 1000 / 60 / 60\r\n\r\n            shift.hours += rec.hours\r\n            shift.workers++\r\n        })\r\n\r\n        shift.perhour = shift.tip ? Number((shift.tip / shift.hours).toFixed(2)) : 0\r\n        shift.deposit = shift.perhour <= 30 ? 0 : shift.hours * 10\r\n    }\r\n\r\n    const leadZero: (n: number) => string = (n) => n < 10 ? `0${n}` : n.toString()\r\n\r\n    console.log(shift)\r\n\r\n    const handleAddRecordOpen = ( e?: React.MouseEvent ) => {\r\n        setAddRecordBox({ date: new Date(shift.date), kind: getKindByDate(new Date(shift.date)) })\r\n    }\r\n\r\n    const handleSignRecord = () => {\r\n        doSignRecord({\r\n            variables: { \r\n                input: { date: shift.date }\r\n             }\r\n        })\r\n        .then(({ data }) => {\r\n            console.log(data)\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    const headers: { [key: string]: { text: string, flex?: number, value: (r: any) => string | JSX.Element } } = {\r\n        index: {\r\n            text: '#',\r\n            value: (r) => shift.records.indexOf(r) + 1\r\n        },\r\n        firstname: {\r\n            text: ' ',\r\n            flex: 2,\r\n            value: (r) => r.user.firstname\r\n        },\r\n        lastname: {\r\n            text: ' ',\r\n            flex: 2,\r\n            value: (r) => r.user.lastname\r\n        },\r\n        id: {\r\n            text: ' ',\r\n            flex: 2,\r\n            value: (r) => r.user.id\r\n        },\r\n        start: {\r\n            text: '',\r\n            value: (r) => `${ leadZero(r.start.getHours()) }:${ leadZero(r.start.getMinutes()) }`\r\n        },\r\n        end: {\r\n            text: '',\r\n            value: (r) => `${ leadZero(r.end.getHours()) }:${ leadZero(r.end.getMinutes()) }`\r\n        },\r\n        hours: {\r\n            text: '',\r\n            value: (r) => r.hours\r\n        },\r\n        tip: {\r\n            text: '',\r\n            value: (r) => shift.perhour ? (r.hours * shift.perhour).toFixed(2) : ''\r\n        },\r\n        discount: {\r\n            text: '',\r\n            value: (r) => shift.perhour ? shift.perhour > 30 ? ((r.hours * shift.perhour) - (r.hours * 10)).toFixed(2) : (r.hours * shift.perhour).toFixed(2) : ''\r\n        },\r\n        deposit: {\r\n            text: '',\r\n            value: (r) => shift.perhour ? shift.perhour > 30 ? (r.hours * 10).toFixed(2) : ((r.hours * 30) - (r.hours * shift.perhour)).toFixed(2) : ''\r\n        },\r\n        sign: {\r\n            text: '',\r\n            value: (r) => r.signed ? '' : shift.status.signed && r.user.id === auth.user.id ? <button className={classes.signRecordButton} onClick={handleSignRecord}></button> : ''\r\n        }\r\n    }\r\n\r\n    const totals: { [key: string]: string } = {\r\n        tip: '\" ',\r\n        hours: '\" ',\r\n        perhour: ' ',\r\n        deposit: '\" '\r\n    }\r\n\r\n    if (smallScreen) return (\r\n        <>\r\n            {\r\n                addRecordBox && <AddRecordBox shift={addRecordBox} onSubmit={() => setAddRecordBox(undefined)} onCancel={() => setAddRecordBox(undefined)} />\r\n            }\r\n            <div style={{ width: '100%', flex: 1 }}>\r\n                {\r\n                    shift.records.length === 0 && <h3>   </h3>\r\n                }\r\n                {\r\n                    !shift.isInShift && !shift.status.closed && <button className={classes.addRecordButton} onClick={handleAddRecordOpen}> </button>\r\n                }\r\n            </div>\r\n            <div style={{ flexDirection: 'row', flexWrap: 'wrap' }}>\r\n                {\r\n                    shift.records.map((record: any, ri: number) => (\r\n                        <div key={ri} style={{ flex: 1, margin: '10px 0 0', minWidth: '280px', width: '100%', boxSizing: 'border-box', borderRadius: '8px', overflow: 'hidden', border: '.5px solid #bbb' }}>\r\n                            {\r\n                                Object.keys(headers).map((key: string, hi: number) => {\r\n                                    if (hi === 0) return <Fragment key={key}></Fragment>\r\n                                    return (\r\n                                        <div key={hi} style={{ flexDirection: 'row', borderBottom: hi+1 !== Object.keys(headers).length ? '.5px solid #bbb' : 0 }}>\r\n                                            <div style={{ padding: '4px 8px', boxSizing: 'border-box', backgroundColor: '#eee', flex: 1 }}>{ headers[key].text }</div>\r\n                                            <div style={{ padding: '4px 8px', boxSizing: 'border-box', flex: 1 }}>{ headers[key].value(record) }</div>\r\n                                        </div>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </div>\r\n                    ))\r\n                }\r\n            </div>\r\n        </>\r\n    )\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            {\r\n                addRecordBox && <AddRecordBox shift={addRecordBox} onSubmit={() => setAddRecordBox(undefined)} onCancel={() => setAddRecordBox(undefined)} />\r\n            }\r\n            <header className={classes.header} style={{flexDirection: 'row'}}>\r\n                {\r\n                    Object.keys(headers).map((key: string, i: number) => {\r\n                        return (\r\n                            <div key={i} style={{ alignItems: 'center', flex: i === 0 ? 0 : headers[key].flex || 1 }}>\r\n                                { headers[key].text }\r\n                            </div>\r\n                        )\r\n                    })\r\n                }    \r\n            </header> \r\n            <main className={classes.main}>\r\n                {\r\n                    shift.records.map((record: any, ri: number) => (\r\n                        <div className={classes.row} key={ri} style={{flexDirection: 'row'}}>\r\n                            {\r\n                                Object.keys(headers).map((key: string, hi: number) => {\r\n                                    return (\r\n                                        <div className={classes.cell} key={hi} style={{ alignItems: 'center', flex: hi === 0 ? 0 : headers[key].flex || 1 }}>\r\n                                            { headers[key].value(record) }\r\n                                        </div>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </div>\r\n                    ))\r\n                }\r\n                {\r\n                    shift.records.length === 0 &&\r\n                    <div className={classes.titleRow}>   </div>\r\n                }\r\n                {\r\n                    shift.status.opened && !shift.isInShift &&\r\n                    <div className={classes.titleRow}>\r\n                        <button className={classes.addRecordButton} onClick={handleAddRecordOpen}> </button>\r\n                    </div>\r\n                }\r\n            </main>\r\n            <footer className={classes.footer} style={{ flexDirection: 'row', background: shift.records.length % 2 ? '#efefef' : '#fff' }}>\r\n                {\r\n                    Object.keys(totals).map((key: string, i: number) => (\r\n                        <div className={classes.item} key={i} style={{ width: `${ 100 / Object.keys(totals).length }%`}}>\r\n                            <span>{ totals[key] }</span>\r\n                            { shift[key] || 0 } \r\n                        </div>\r\n                    ))\r\n                }\r\n            </footer>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ShiftTable","import { gql } from \"@apollo/client\";\r\n\r\nexport const RECORD_ADDED_SUBSCRIPTION = gql`\r\n    subscription {\r\n        recordAdded {\r\n            start\r\n            end \r\n            user {\r\n                id\r\n                firstname\r\n                lastname \r\n            }\r\n        }\r\n    }\r\n`","import React from 'react'\r\nimport { IAuth } from '../router'\r\nimport AppNav from './AppNav'\r\nimport { useParams, useHistory } from 'react-router-dom'\r\nimport { useQuery, useMutation } from '@apollo/client'\r\nimport { GET_SHIFT } from '../apollo/query'\r\nimport { isToday, months, weekdays } from './Datepicker'\r\nimport DateBar from './Datebar'\r\nimport ShiftTable, { withZero, useFloatBoxStyles } from './ShiftTable'\r\nimport KindBar, { Kind, getKindByDate } from './KindBar'\r\nimport { makeStyles, Theme, useMediaQuery } from '@material-ui/core'\r\nimport { CLOSE_SHIFT_MUTATION, SIGN_SHIFT_MUTATION } from '../apollo/mutation'\r\nimport { RECORD_ADDED_SUBSCRIPTION } from '../apollo/subscriptions'\r\n\r\ninterface ShiftViewParams {\r\n    date?: Date\r\n    kind?: Kind\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    header: {\r\n        flexDirection: 'row',\r\n        flexWrap: 'wrap',\r\n        justifyContent: 'space-between',\r\n        padding: '20px 0',\r\n        [theme.breakpoints.down(521)]: {\r\n            flexDirection: 'column'\r\n        },\r\n    },\r\n    main: {\r\n        marginBottom: '20px'\r\n    },\r\n    closeShiftButton: {\r\n        background: '#f44336',\r\n        color: '#fff',\r\n        fontWeight: 500,\r\n        border: 0,\r\n        display: 'flex',\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        borderRadius: '8px',\r\n        marginRight: '10px',\r\n        padding: '0 10px',\r\n        boxSizing: 'border-box',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transprent'\r\n    },\r\n    signShiftButton: {\r\n        background: '#4caf50',\r\n        color: '#fff',\r\n        fontWeight: 500,\r\n        border: 0,\r\n        display: 'flex',\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        borderRadius: '8px',\r\n        marginRight: '10px',\r\n        padding: '0 10px',\r\n        boxSizing: 'border-box',\r\n        cursor: 'pointer',\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transprent'\r\n    }\r\n}))\r\n\r\nconst CloseShiftButton: React.FC<{ date: Date }> = ({ date }) => {\r\n    const classes = useStyles()\r\n    const boxClasses = useFloatBoxStyles()\r\n    const [ open, setOpen ] = React.useState<boolean>(false)\r\n    const [ tip, setTip ] = React.useState<number>(0)\r\n\r\n    const [ doClose ] = useMutation(CLOSE_SHIFT_MUTATION)\r\n\r\n    const handleSubmit = ( e?: React.MouseEvent ) => {\r\n        doClose({\r\n            variables: {\r\n                input: {\r\n                    date,\r\n                    tip\r\n                }\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            console.log(data)\r\n            setOpen(false)\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {\r\n                open &&\r\n                <div style={{ zIndex: 1499, position: 'fixed', width: '100%', height: '100%', top: 0, left: 0 }}>\r\n                    <div className={boxClasses.container}>\r\n                        <div onClick={e => setOpen(false)} className={boxClasses.outline}></div>\r\n                        <div className={boxClasses.box}>\r\n                            <header className={boxClasses.header}>\r\n                                <h3> </h3>\r\n                                <span>{ date.getDate() } { months[date.getMonth()] }, { date.getFullYear() }</span>\r\n                            </header>\r\n                            <main className={boxClasses.main}>\r\n                                <h4>  </h4>\r\n                                <input type=\"number\" value={tip.toString()} onChange={e => setTip(Number(e.currentTarget.value))} />\r\n                            </main>\r\n                            <footer className={boxClasses.footer}>\r\n                                <button onClick={handleSubmit}></button>\r\n                                <button onClick={e => setOpen(false)}></button>\r\n                            </footer>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            }\r\n            <div>\r\n                <button className={classes.closeShiftButton} onClick={e => setOpen(true)}> </button>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nconst SignShiftButton: React.FC<{ date: Date }> = ({ date }) => {\r\n    const classes = useStyles()\r\n    const [ doClose, { loading } ] = useMutation(SIGN_SHIFT_MUTATION)\r\n\r\n    const handleClick = ( e?: React.MouseEvent ) => {\r\n        doClose({\r\n            variables: {\r\n                input: { date }\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            console.log(data)\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <button className={classes.signShiftButton} disabled={loading} onClick={handleClick}> </button>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport const DateTimeString: React.FC<{ date?: Date }> = ({ date = new Date() }) => {\r\n    \r\n    return (\r\n        <time dateTime={date.toLocaleString()}>\r\n            { withZero(date.getHours()) }:{ withZero(date.getMinutes()) }, { weekdays.long[ date.getDay() ]}, { date.getDate() } { months[date.getMonth() ]} { date.getFullYear() }\r\n        </time>\r\n    )\r\n}\r\n\r\nconst ShiftView: React.FC<{ auth: IAuth }> = ({ auth }) => {\r\n    const smallScreen = useMediaQuery('(max-width: 520px)')\r\n    const classes = useStyles()\r\n    const history = useHistory()\r\n    const params: ShiftViewParams = useParams() as ShiftViewParams\r\n    let { date, kind } = params\r\n\r\n    date = date ? new Date(date) : new Date()\r\n    kind = kind ? kind : getKindByDate(date)\r\n    \r\n    const { loading, error, data, refetch, subscribeToMore } = useQuery(GET_SHIFT, {\r\n        variables: {\r\n            date: new Date(date.getFullYear(), date.getMonth(), date.getDate(), kind === Kind.MORNING ? 9 : 16, 0, 0)\r\n        },\r\n        fetchPolicy: 'no-cache'\r\n    })\r\n\r\n    subscribeToMore({\r\n        document: RECORD_ADDED_SUBSCRIPTION,\r\n        updateQuery: (prev, { subscriptionData }) => {\r\n            refetch()\r\n        }\r\n    })\r\n    \r\n    const todayKind = getKindByDate(new Date())\r\n\r\n    const handleDateChange = ( date: Date ) => {\r\n        const dateURI = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`\r\n        if (isToday(date) && todayKind === kind) return history.push('/')\r\n\r\n        return history.push(`/s/${dateURI}/${kind}`)\r\n    }\r\n\r\n    const handleKindChange = ( kind: Kind ) => {\r\n        const d = date || new Date()\r\n        const dateURI = `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`\r\n\r\n        if (isToday(d) && todayKind === kind) return history.push('/')\r\n\r\n        return history.push(`/s/${dateURI}/${kind}`)\r\n    }\r\n\r\n    const { getShift: shift } = data ? data : { getShift: null }\r\n\r\n    const needSign = !loading && data ? (auth.user.role === '' || auth.user.role === '') && !Boolean(shift.status.signed) && Boolean(shift.status.closed) : false\r\n    const needClose = !loading && data && !Boolean(shift.status.closed) && shift.isInShift\r\n\r\n    const PrivacyCheck = () => {\r\n        if (loading || error || !data) return <div></div> \r\n        if (shift.status.closed && !shift.isInShift && auth.user.role === '') return (\r\n            <div>\r\n                <h3> </h3>\r\n                <p>       </p>\r\n            </div>\r\n        )\r\n\r\n        const closed = shift.status.closed ? { ...shift.status.closed, date: new Date(shift.status.closed.date) } : null\r\n        const signed = shift.status.signed ? { ...shift.status.signed, date: new Date(shift.status.signed.date) } : null\r\n        \r\n        return (\r\n            <div>\r\n                {\r\n                    shift.status.closed && \r\n                    <div>\r\n                        <h3> </h3>\r\n                        {\r\n                            closed &&\r\n                            <p>\r\n                                   <b>{ closed.user.firstname } { closed.user.lastname }</b> <DateTimeString date={closed.date} />\r\n                            </p>\r\n                        }\r\n                        {\r\n                            signed && \r\n                            <p>\r\n                                   <b>{ signed.user.firstname } { signed.user.lastname }</b> <DateTimeString date={signed.date} />\r\n                            </p>\r\n                        }\r\n                    </div>\r\n                }\r\n                <ShiftTable auth={auth} loading={loading} error={error} data={data} />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <AppNav auth={auth}>\r\n            <header className={classes.header}>\r\n                <DateBar handleChange={handleDateChange} date={date} />\r\n                <div style={{ position: 'relative', marginTop: smallScreen ? '10px' : 0, width: smallScreen ? '100%' : 'auto', flexDirection: 'row', justifyContent: 'space-between' }}>\r\n                    <KindBar kind={kind} handleChange={handleKindChange} />\r\n                    {\r\n                        needSign && <SignShiftButton date={new Date(shift.date)} />\r\n                    }\r\n                    {\r\n                        needClose && <CloseShiftButton date={new Date(shift.date)} />\r\n                    }\r\n                </div>\r\n            </header>\r\n            <main className={classes.main}>\r\n                <PrivacyCheck />\r\n            </main>\r\n        </AppNav>\r\n    )\r\n}\r\n\r\nexport default ShiftView","import React from 'react'\r\nimport { IAuth } from '../router';\r\nimport ShiftView from './ShiftView';\r\n\r\nexport interface HomeViewProps {\r\n    auth: IAuth\r\n}\r\n\r\nconst HomeView: React.FC<{ auth: IAuth }> = ({ auth }) => {\r\n    return (\r\n        <ShiftView auth={auth} />\r\n    )\r\n}\r\n\r\n// const MobileView: React.FC<{ auth: IAuth }> = ({ auth }) => {\r\n//     return (\r\n//         <div>\r\n//             Home MobileView\r\n//         </div>\r\n//     )\r\n// }\r\n\r\n// const Responsive: React.FC<{ auth: any }> = ({ auth }) => {\r\n//     const smallScreen = useMediaQuery('(max-width: 480px)')\r\n\r\n//     if (smallScreen) return <MobileView auth={auth} />\r\n\r\n//     return <HomeView auth={auth} />\r\n// }\r\n\r\nexport default HomeView","import React from 'react'\r\nimport { LOGIN_MUTATION } from '../apollo/mutation' \r\nimport { \r\n    Lock as LockIcon,\r\n    LockOutlined as PasswordIcon,\r\n    PersonOutline as IdIcon\r\n} from '@material-ui/icons'\r\nimport { OverridableComponent } from '@material-ui/core/OverridableComponent'\r\nimport { CircularProgress, makeStyles, Theme, Button } from '@material-ui/core'\r\nimport { useMutation } from '@apollo/client'\r\nimport clsx from 'clsx'\r\n\r\ninterface LoginState {\r\n    error?: string | null\r\n    loading?: boolean\r\n    input: {\r\n        id: string\r\n        password: string\r\n    }\r\n}\r\n\r\ninterface LoginField {\r\n    type: 'text' | 'password' | 'submit'\r\n    name: 'id' | 'password'\r\n    icon: OverridableComponent<any>\r\n    placeholder: string\r\n}\r\n\r\nconst fields: LoginField[] = [\r\n    {\r\n        type: 'text',\r\n        name: 'id',\r\n        icon: IdIcon,\r\n        placeholder: ' \"'\r\n    },\r\n    {\r\n        type: 'password',\r\n        name: 'password',\r\n        icon: PasswordIcon,\r\n        placeholder: ''\r\n    }\r\n]\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        height: '100%',\r\n    },\r\n    wrapper: {\r\n        maxWidth: '480px',\r\n        width: '100%',\r\n        margin: 'auto auto',\r\n        flexDirection: 'column',\r\n        [theme.breakpoints.down(500)]: {\r\n            padding: '0 20px',\r\n            margin: 'auto 0',\r\n        }\r\n    },\r\n    header: {\r\n        width: '100%',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        '& div.lock-icon': {\r\n            '& svg': {\r\n                fontSize: '64px',\r\n                color: '#6c5549'\r\n            }\r\n        },\r\n        '& h1': {\r\n            fontSize: '22px',\r\n            fontWeight: 700,\r\n            letterSpacing: '.0875rem',\r\n            textAlign: 'center',\r\n            color: '#6c5549',\r\n        },\r\n        '& p': {\r\n            color: '#999',\r\n            maxWidth: '80%',\r\n            textAlign: 'center',\r\n            margin: '12px 0',\r\n            fontSize: '16px',\r\n        }\r\n    },\r\n    content: {\r\n        position: 'relative'\r\n    },\r\n    inputField: {\r\n        flexDirection: 'row',\r\n        width: '60%',\r\n        margin: '0 auto',\r\n        justifyContent: 'center',\r\n        height: '60px',\r\n    },\r\n    inputIcon: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        height: '100%',\r\n        marginLeft: '5px',\r\n        '& svg': {\r\n            fontSize: '34px',\r\n            color: '#999'\r\n        },\r\n        '&.active': {\r\n            '& svg': {\r\n                color: '#6c5549'\r\n            }\r\n        }\r\n    },\r\n    input: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        width: '100%',\r\n        fontSize: '18px',\r\n        border: 0,\r\n        borderBottom: '1.5px solid #999',\r\n        background: 0,\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        padding: '4px 8px',\r\n        boxSizing: 'border-box',\r\n        '&:focus': {\r\n            borderColor: '#6c5549'\r\n        }\r\n    },\r\n    submitButton: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: '60%',\r\n        minHeight: '40px',\r\n        margin: '12px auto',\r\n        backgroundColor: '#4caf50',\r\n        color: '#fff',\r\n        fontSize: '14px',\r\n        fontWeight: 600,\r\n        userSelect: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        '&:hover': {\r\n            backgroundColor: '#357a38'\r\n        },\r\n        '&:disabled': {\r\n            opacity: .5\r\n        },\r\n        '& svg': {\r\n            color: '#0089c0'\r\n        }\r\n    },\r\n    errorMessage: {\r\n        position: 'absolute',\r\n        top: '110%',\r\n        width: '100%',\r\n        color: '#f44336',\r\n        fontSize: '16px',\r\n        fontWeight: 400,\r\n        alignItems: 'center'\r\n    }\r\n}))\r\n\r\nconst LoginView: React.FC = () => {\r\n    const classes = useStyles()\r\n    const [ active, setActive ] = React.useState<'id' | 'password' | null>(null)\r\n    const [ state, setState ] = React.useState<LoginState>({\r\n        input: {\r\n            id: '',\r\n            password: ''\r\n        }\r\n    })\r\n\r\n    const [ doLogin ] = useMutation(LOGIN_MUTATION)\r\n\r\n    const handleFocus = ( e: React.FocusEvent<HTMLInputElement>) => {\r\n        e.currentTarget.readOnly = false\r\n        setActive(e.currentTarget.name as 'id' | 'password')\r\n    }\r\n\r\n    const handleChange = ( e: React.ChangeEvent<HTMLInputElement> ) => {\r\n        if (e.currentTarget.name === 'id' && isNaN(Number(e.currentTarget.value))) {\r\n            return e.preventDefault()\r\n        }\r\n        return setState({ ...state, error: null, input: { ...state.input, [e.currentTarget.name]: e.currentTarget.value }})\r\n    }\r\n\r\n    const handleSubmit = ( e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault()\r\n\r\n        setState({ ...state, loading: true })\r\n\r\n        doLogin({\r\n            variables: {\r\n                input: state.input\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            const { Login } = data as { Login: { token: string } }\r\n            const { token } = Login\r\n\r\n            if (!token) return setState({ ...state, loading: false, error: '       ' })\r\n            else {\r\n                localStorage.setItem('token', token)\r\n                return window.location.reload()\r\n            }\r\n        })\r\n        .catch(err => {\r\n            setState({ ...state, loading: false, error: err.message })\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <div className={classes.wrapper}>\r\n                <header className={classes.header}>\r\n                    <div className=\"lock-icon\">\r\n                        <LockIcon />\r\n                    </div>\r\n                    <h1></h1>\r\n                    <p>     ,    ,   .</p>\r\n                </header>\r\n                <main className={classes.content}>\r\n                    <form onSubmit={handleSubmit} autoComplete=\"off\">\r\n                        {\r\n                            fields.map((field: LoginField, i: number) => {\r\n                                return (\r\n                                    <div key={i} className={classes.inputField}>\r\n                                        <label htmlFor={field.name} className={clsx(classes.inputIcon, field.name === active && 'active')}>\r\n                                            <field.icon />\r\n                                        </label>\r\n                                        <div style={{ alignItems: 'center', justifyContent: 'center', height: '60px'}}>\r\n                                            <input readOnly onBlur={() => setActive(null)} onFocus={handleFocus} className={classes.input} type={field.type} placeholder={field.placeholder} value={state.input[field.name]} name={field.name} id={field.name} onChange={handleChange} />\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            })\r\n                        }\r\n                        <div>\r\n                            <Button variant=\"contained\" color=\"inherit\" className={classes.submitButton} type=\"submit\" disabled={ Boolean(state.loading || state.error || !state.input.id || !state.input.password) }>\r\n                                {\r\n                                    state.loading \r\n                                    ? <div><CircularProgress size={25} /></div>\r\n                                    : ''\r\n                                }\r\n                            </Button>\r\n                        </div>\r\n                        {\r\n                            state.error &&\r\n                            <div className={classes.errorMessage}>\r\n                                { state.error }\r\n                            </div>\r\n                        }\r\n                    </form>\r\n                </main>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default LoginView","import React from 'react'\r\nimport { IAuth } from '../router'\r\nimport AppNav from './AppNav'\r\nimport { Avatar, Theme, makeStyles } from '@material-ui/core'\r\nimport { useQuery, useMutation } from '@apollo/client'\r\nimport { GET_USER_SHIFTS } from '../apollo/query'\r\nimport { weekdays, months } from './Datepicker'\r\nimport { Link } from 'react-router-dom'\r\nimport { getKindByDate } from './KindBar'\r\nimport { SIGN_RECORD_MUTATION } from '../apollo/mutation'\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    row: {\r\n        flexDirection: 'row',\r\n        '& div': {\r\n            flex: 1,\r\n        }\r\n    }\r\n}))\r\n\r\nconst ShiftList: React.FC<{ onChange?: () => void, auth: IAuth, items: any, type: 'opened' | 'closed' | 'unsigned' | 'waiting' }> = ({ onChange, auth, items, type }) => {\r\n    const classes = useStyles()\r\n    const [ doSignRecord ] = useMutation(SIGN_RECORD_MUTATION)\r\n\r\n    const handleSignRecord = ( d: Date ) => {\r\n        doSignRecord({\r\n            variables: {\r\n                input: { date: d }\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            onChange?.()\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                items.length > 0 &&\r\n                <header className={classes.row}>\r\n                    <div></div>\r\n                    <div></div>\r\n                    <div></div>\r\n                    <div></div>\r\n                    <div></div>\r\n                    <div></div>\r\n                    <div>/</div>\r\n                    <div></div>\r\n                </header>\r\n            }\r\n            <main>\r\n                {\r\n                    items.length === 0 && <div> </div>\r\n                }\r\n                {\r\n                    items.map((item: any, i: number) => {\r\n                        const date = new Date(item.date)\r\n                        const record = item.records.find((r: any) => r.user.id === auth.user.id)\r\n                        const hours = (new Date(record.end).getTime() - new Date(record.start).getTime() ) / 1000 / 60 / 60\r\n                        let totalHours = 0\r\n\r\n                        item.records.forEach((r: any) => {\r\n                            totalHours += (new Date(r.end).getTime() - new Date(r.start).getTime() ) / 1000 / 60 / 60\r\n                        })\r\n                        \r\n                        let perhour = item.tip / totalHours\r\n                        const tip = perhour * hours\r\n                        const discharge = perhour <= 30 ? (hours * 30) - tip : hours * -10\r\n                        const deposit = perhour <= 30 ? tip : tip + discharge\r\n\r\n                        const types = [ 'closed', 'unsigned' ]\r\n\r\n                        return (\r\n                            <div key={i} className={classes.row}>\r\n                                <div>\r\n                                    { weekdays.long[date.getDay()] }, { date.getDate() } { months[date.getMonth()] }, { date.getFullYear() }\r\n                                </div>\r\n                                <div>\r\n                                    { getKindByDate(date) }\r\n                                </div>\r\n                                <div>\r\n                                    { hours }\r\n                                </div>\r\n                                <div>\r\n                                    { perhour.toFixed(2) }\r\n                                </div>\r\n                                <div>\r\n                                    {\r\n                                        types.includes(type)\r\n                                        ? `${tip.toFixed(2)}`\r\n                                        : '-'\r\n                                    }\r\n                                </div>\r\n                                <div>\r\n                                    {\r\n                                        types.includes(type)\r\n                                        ? `${deposit.toFixed(2)}`\r\n                                        : '-'\r\n                                    }\r\n                                </div>\r\n                                <div>\r\n                                    {\r\n                                        types.includes(type)\r\n                                        ? `${discharge.toFixed(2)}`\r\n                                        : '-'\r\n                                    }\r\n                                </div>\r\n                                <div>\r\n                                    <Link to={`/s/${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}/${getKindByDate(date)}`}> </Link>\r\n                                    {\r\n                                        type === 'unsigned' && <button onClick={e => handleSignRecord(date)}></button>\r\n                                    }\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    })\r\n                }\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst ProfileView: React.FC<{ auth: IAuth }> = ({ auth }) => {\r\n    const { loading, error, data, refetch } = useQuery(GET_USER_SHIFTS, {\r\n        fetchPolicy: 'no-cache'\r\n    })\r\n\r\n    if (loading ) return <div></div>\r\n\r\n    if (error) return <div>{ error.message }</div>\r\n\r\n    const { getUserShifts: shifts } = data || {}\r\n    \r\n    const opened = shifts.filter((r: any) => r.status.opened)\r\n    const closed = shifts.filter((r: any) => r.status.closed && r.records.find((d: any) => d.user.id === auth.user.id && d.signed))\r\n    const unsigned = shifts.filter((r: any) => r.status.signed && r.records.find((d: any) => d.user.id === auth.user.id && !d.signed))\r\n    const waiting = shifts.filter((r: any) => r.status.closed && !r.status.signed && r.records.find((d: any) => d.user.id === auth.user.id))\r\n\r\n    console.log({ opened, closed, unsigned })\r\n\r\n    let hours = 0, tip = 0, deposit = 0, discharge = 0, completion = 0\r\n    shifts.forEach((shift: any) => {\r\n        shift.hours = 0\r\n\r\n        shift.records.forEach((r: any) => {\r\n            r.hours = (new Date(r.end).getTime() - new Date(r.start).getTime() ) / 1000 / 60 / 60\r\n\r\n            shift.hours += r.hours\r\n        })\r\n        \r\n        shift.perhour = shift.tip ? shift.tip / shift.hours : 0\r\n\r\n        const record = shift.records.find((r: any) => r.user.id === auth.user.id)\r\n\r\n        record.tip = shift.perhour * record.hours\r\n        record.discharge = shift.perhour <= 30 ? (record.hours * 30) - record.tip : record.hours * -10\r\n        record.deposit = shift.perhour <= 30 ? record.tip : record.tip + record.discharge\r\n\r\n        hours += !shift.status.opened && record.hours\r\n        tip += !shift.status.opened && record.tip\r\n        deposit += !shift.status.opened && record.deposit\r\n        discharge += !shift.status.opened && record.discharge\r\n        completion += !shift.status.opened && record.discharge > 0 ? record.discharge : 0\r\n    })\r\n\r\n    const averageHours = hours / shifts.length\r\n    const averagePerHour = tip / hours\r\n\r\n    return (\r\n        <AppNav auth={auth}>\r\n            <header>\r\n                <button>\r\n                    <Avatar src={`http://${window.location.hostname}:4000${auth.user.avatar}`} />\r\n                </button>\r\n                <div>\r\n                    <h1>{ auth.user.firstname } { auth.user.lastname }</h1>\r\n                    <p style={{ direction: 'ltr', width: 'auto', textAlign: 'right' }}>@{ auth.user.username }</p>\r\n                </div>\r\n                <div>\r\n                    <button> </button>\r\n                </div>\r\n            </header>\r\n            <main>\r\n                <div>\r\n                    <h3></h3>\r\n                    <div>\r\n                        <span>\" : </span> { hours }\r\n                    </div>\r\n                    <div>\r\n                        <span>\" : </span> { shifts.length }\r\n                    </div>\r\n                    <div>\r\n                        <span>\" : </span> { tip.toFixed(2) }\r\n                    </div>\r\n                    <div>\r\n                        <span>\" : </span> { deposit.toFixed(2) }\r\n                    </div>\r\n                    <div>\r\n                        <span>\" : </span> { discharge.toFixed(2) }\r\n                    </div>\r\n                    <div>\r\n                        <span>\" : </span> { completion.toFixed(2) }\r\n                    </div>\r\n                    <div>\r\n                        <span>  : </span> { averageHours.toFixed(2) }\r\n                    </div>\r\n                    <div>\r\n                        <span>  : </span> { averagePerHour.toFixed(2) }\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <h3> </h3>\r\n                    <ShiftList auth={auth} items={opened} type=\"opened\" />\r\n                </div>\r\n                <div>\r\n                    <h3>   </h3>\r\n                    <ShiftList onChange={() => refetch()} auth={auth} items={unsigned} type=\"unsigned\" />\r\n                </div>\r\n                <div>\r\n                    <h3>   </h3>\r\n                    <ShiftList auth={auth} items={waiting} type=\"waiting\" />\r\n                </div>\r\n                <div>\r\n                    <h3> </h3>\r\n                    <ShiftList auth={auth} items={closed} type=\"closed\" />\r\n                </div>\r\n            </main>\r\n        </AppNav>\r\n    )\r\n}\r\n\r\nexport default ProfileView","import React from 'react'\r\nimport { makeStyles, Theme, Avatar } from '@material-ui/core'\r\nimport { useMutation, useQuery } from '@apollo/client'\r\nimport { ADD_ACCOUNT_MUTATION, DELETE_ACCOUNT_MUTATION, UPDATE_ACCOUNT_MUTATION } from '../apollo/mutation'\r\nimport { GET_USERS_QUERY } from '../apollo/query'\r\nimport { IAuth } from '../router'\r\n\r\ninterface IState {\r\n    loading?: boolean\r\n    error?: string | null\r\n    success?: string | null\r\n}\r\n\r\ninterface AddAccountState extends IState {\r\n    input: {\r\n        id: string\r\n        firstname: string\r\n        lastname: string\r\n        [key: string]: string\r\n    }\r\n}\r\n\r\ninterface AddAccountField {\r\n    name: string\r\n    placeholder: string\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        flex: 1,\r\n        padding: '10px 0',\r\n        boxSizing: 'border-box'\r\n    },\r\n    fields: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        flexWrap: 'wrap',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        [theme.breakpoints.down(480)]: {\r\n            flexDirection: 'column',\r\n            alignItems: 'flex-start',\r\n            margin: '10px'\r\n        }\r\n    },\r\n    field: {\r\n        '& input': {\r\n            margin: '5px',\r\n            outline: 'none',\r\n            WebkitTapHighlightColor: 'transparent'\r\n        }\r\n    },\r\n    form: {\r\n        display: 'flex',\r\n        flex: 1,\r\n        alignItems: 'center',\r\n        flexDirection: 'column'\r\n    },\r\n    formError: {\r\n        width: '100%',\r\n        color: 'red',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    formControls: {\r\n        flexDirection: 'row',\r\n        [theme.breakpoints.down(640)]: {\r\n            width: '100%',\r\n            alignItems: 'center',\r\n            justifyContent: 'center'\r\n        },\r\n        '& button': {\r\n            margin: '0 5px',\r\n        }\r\n    },\r\n    usersList: {\r\n        flex: 1,\r\n        flexDirection: 'row',\r\n        flexWrap: 'wrap',\r\n        padding: '0 10px',\r\n        boxSizing: 'border-box',\r\n        maxHeight: '200px',\r\n        overflowY: 'auto'\r\n    },\r\n    userCardContainer: {\r\n        minWidth: '200px',\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        padding: '10px 16px',\r\n        boxSizing: 'border-box',\r\n        border: '.5px solid #eee',\r\n        borderRadius: '8px',\r\n        '&:not(last-child)': {\r\n            marginLeft: '8px',\r\n            marginBottom: '8px',\r\n        }\r\n    },\r\n    userCardAvatar: {},\r\n    userCardDetails: {\r\n        flex: 1,\r\n        flexDirection: 'column',\r\n        marginRight: '8px',\r\n        '& h3.fullname': {\r\n            fontSize: '16px',\r\n            fontWeight: 500,\r\n        },\r\n        '& div.username': {\r\n            fontSize: '12px',\r\n            color: '#949494',\r\n            direction: 'ltr',\r\n            textAlign: 'right'\r\n        },\r\n        '& div.item': {\r\n            flexDirection: 'row',\r\n            fontWeight: 500,\r\n            alignItems: 'center',\r\n            '& span': {\r\n                marginRight: '.3rem',\r\n                fontWeight: 400\r\n            }\r\n        }\r\n    },\r\n    searchHeader: {\r\n        padding: '0 10px',\r\n        marginBottom: '10px',\r\n        '& input': {\r\n            outline: 'none',\r\n            padding: '10px 16px',\r\n            boxSizing: 'border-box',\r\n            border: '.5px solid #eee',\r\n            borderRadius: '8px'\r\n        }\r\n    },\r\n    noResultsTitle: {\r\n        flexDirection: 'row',\r\n        '& b': {\r\n            fontWeight: 500\r\n        }\r\n    },\r\n    userSelect: {\r\n        margin: '0 10px',\r\n        padding: '10px 16px',\r\n        boxSizing: 'border-box',\r\n        outline: 'none',\r\n        WebkitTapHighlightColor: 'transparent',\r\n        fontSize: '14px',\r\n        border: '.5px solid #eee',\r\n        borderRadius: '8px',\r\n        WebkitAppearance: 'none',\r\n        MozAppearance: 'none',\r\n        textIndent: '1px',\r\n        textOverflow: ''\r\n    },\r\n}))\r\n\r\ninterface ITitle {\r\n    text: string\r\n    data: string\r\n}\r\n\r\nexport const DeleteUser: React.FC<{ onClose: () => void, opened: boolean }> = ({ onClose, opened }) => {\r\n    const classes = useStyles()\r\n    const { loading, error, data } = useQuery(GET_USERS_QUERY, {\r\n        skip: !opened,\r\n    })\r\n    const [ user, setUser ] = React.useState<IAuth['user'] | null>(null)\r\n    const [ doDelete ] = useMutation(DELETE_ACCOUNT_MUTATION)\r\n    const [ deleteError, setError ] = React.useState<string | null>(null)\r\n\r\n    if (loading || !data) return <div> ...</div>\r\n\r\n    if (error) return (\r\n        <div>\r\n            <h1> </h1>\r\n            <p>     </p>\r\n        </div>\r\n    )\r\n    \r\n    const { getUsers: users } = data || [] as IAuth['user'][]\r\n\r\n    const handleChange = ( e: React.ChangeEvent<HTMLSelectElement> ) => {\r\n        setUser(users.find((user: IAuth['user']) => user.id === e.currentTarget.value) || null)\r\n        setError(null)\r\n    }\r\n\r\n    const handleConfirm = () => {\r\n        doDelete({\r\n            variables: {\r\n                id: user?.id\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            console.log(data)\r\n        })\r\n        .catch(err => {\r\n            setError(err.message)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <select defaultValue={user?.id || 0} onChange={handleChange}>\r\n                <option value={0} disabled> </option>\r\n                {\r\n                    users.map((user: IAuth['user'], i: number) => (\r\n                        <option key={i} value={user.id}>{ user.firstname } { user.lastname }</option>\r\n                    ))\r\n                }\r\n            </select>\r\n            {\r\n                user && \r\n                <div>\r\n                    <p>    <b>{ user.firstname } { user.lastname } ,   .     ?</b></p>\r\n                    <button onClick={handleConfirm}></button>\r\n                    <button onClick={() => onClose()}></button>\r\n                </div>\r\n            }\r\n            {\r\n                deleteError &&\r\n                <div>\r\n                    { deleteError }\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const UsersList: React.FC<{ onClose?: () => void, opened: boolean }> = ({ onClose, opened }) => {\r\n    const classes = useStyles()\r\n    const [ filtered, setFiltered ] = React.useState<IAuth['user'][]>([])\r\n    const { loading, error, data, refetch } = useQuery(GET_USERS_QUERY, {\r\n        onCompleted: () => {\r\n            const { getUsers: users } = data || []\r\n            setFiltered(users)\r\n        }\r\n    })\r\n    const [ search, setSearch ] = React.useState<string>('')\r\n\r\n    React.useEffect(() => {\r\n        refetch()\r\n    })\r\n\r\n    if (loading || !data) return <div> ...</div>\r\n\r\n    if (error) return (\r\n        <div>\r\n            <h1> </h1>\r\n            <p>     </p>\r\n        </div>\r\n    )\r\n    \r\n    const { getUsers: users } = data || [] as IAuth['user'][]\r\n\r\n    const handleSearch = ( e: React.ChangeEvent<HTMLInputElement> ) => {\r\n        const value = e.currentTarget.value\r\n        setSearch(value)\r\n\r\n        const results = users.filter((user: IAuth['user']) => user.username.startsWith(value) || user.firstname.startsWith(value) || user.lastname.startsWith(value) || user.id.startsWith(value))\r\n        setFiltered(results) \r\n    }\r\n\r\n    const UserCard: React.FC<{ user: IAuth['user'] }> = ({ user }) => {\r\n        return (\r\n            <div className={classes.userCardContainer}>\r\n                <div className={classes.userCardAvatar}>\r\n                    <Avatar src={user.avatar ? `http://${window.location.hostname}:4000${user.avatar}` : ''} />\r\n                </div>\r\n                <div className={classes.userCardDetails}>\r\n                    <h3 className=\"fullname\">{ user.firstname } { user.lastname }</h3>\r\n                    <div className=\"username\">@{ user.username }</div>\r\n                    <div className=\"item\">: <span>{ user.id }</span></div>\r\n                    <div className=\"item\">: <span>{ user.role }</span></div>\r\n                </div>\r\n            </div>\r\n        )\r\n    } \r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <header className={classes.searchHeader}>\r\n                <input type=\"text\" placeholder=\" ,     \" value={search} onChange={handleSearch} />\r\n            </header>\r\n            <main className={classes.usersList}>\r\n                {\r\n                    filtered.map((user: IAuth['user'], i: number) => (\r\n                        <div key={i}>\r\n                            <UserCard user={user} />\r\n                        </div>\r\n                    ))\r\n                }\r\n                {\r\n                    filtered.length === 0 && search && <div className={classes.noResultsTitle}>  &nbsp;<b>{ search }</b></div>\r\n                }\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const AddAccount: React.FC<{ onClose?: () => void }> = ({ onClose }) => {\r\n    const classes = useStyles()\r\n    const initialState = {\r\n        input: {\r\n            id: '',\r\n            firstname: '',\r\n            lastname: ''\r\n        }\r\n    }\r\n    const [ doAddAccount ] = useMutation(ADD_ACCOUNT_MUTATION)\r\n    const [ state, setState ] = React.useState<AddAccountState>(initialState)\r\n\r\n    const handleClose = ( e?: React.MouseEvent<HTMLButtonElement> ) => {\r\n        onClose?.()\r\n    }\r\n\r\n    const handleFocus = ( e: React.FocusEvent<HTMLInputElement> ) => {\r\n        e.currentTarget.readOnly = false\r\n    }\r\n\r\n    const handleChange = ( e: React.ChangeEvent<HTMLInputElement> ) => {\r\n        if (e.currentTarget.name === 'id' && isNaN(Number(e.currentTarget.value))) return e.preventDefault() \r\n\r\n        return setState({ ...state, success: null, error: null, input: { ...state.input, [e.currentTarget.name]: e.currentTarget.value.trim() }})\r\n    }\r\n\r\n    const handleSubmit = ( e: React.FormEvent<HTMLFormElement> ) => {\r\n        e.preventDefault()\r\n        setState({ ...state, loading: true })\r\n\r\n        doAddAccount({\r\n            variables: {\r\n                input: state.input\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            console.log(data)\r\n            return setState({ ...initialState, success: `  `})\r\n        })\r\n        .catch(err => {\r\n            return setState({ ...state, loading: false, error: err.message })\r\n        })\r\n    }\r\n\r\n    const items: AddAccountField[] = [\r\n        {\r\n            name: 'id',\r\n            placeholder: ' '\r\n        },\r\n        {\r\n            name: 'firstname',\r\n            placeholder: ' '\r\n        },\r\n        {\r\n            name: 'lastname',\r\n            placeholder: ' '\r\n        }\r\n    ]\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <form onSubmit={handleSubmit} className={classes.form} autoComplete=\"off\">\r\n                <input style={{display: 'none'}} />\r\n                <div className={classes.fields}>\r\n                    {\r\n                        items.map((field: AddAccountField, i: number) => {\r\n                            return (\r\n                                <div key={i} className={classes.field}>\r\n                                    <input readOnly type=\"text\" { ...field } id={field.name} onFocus={handleFocus} onChange={handleChange} value={state.input[field.name]} />\r\n                                </div>\r\n                            )\r\n                        })\r\n                    }\r\n                    <div className={classes.formControls}>\r\n                        <button type=\"submit\" disabled={Boolean(state.loading || state.error || !state.input.id || !state.input.firstname || !state.input.lastname)}></button>\r\n                        <button onClick={handleClose}></button>\r\n                    </div>\r\n                    {\r\n                        state.error &&\r\n                        <div className={classes.formError}>\r\n                            { state.error }\r\n                        </div>\r\n                    }\r\n                    {\r\n                        state.success &&\r\n                        <div className={classes.formError} style={{ color: 'green' }}>\r\n                            { state.success }\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </form>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface UpdateAccountState {\r\n    account: {\r\n        update: IAuth['user'],\r\n        id?: string\r\n    }\r\n    loading: boolean\r\n    response?: string\r\n    changed: boolean\r\n    error: string | null\r\n}\r\n\r\nexport const UpdateAccount: React.FC<{ onClose?: () => void, opened: boolean }> = ({ onClose, opened }) => {\r\n    const classes = useStyles()\r\n    const [ loaded, setLoaded ] = React.useState<boolean>(false)\r\n    const { loading, error, data, refetch: refetchUsers } = useQuery(GET_USERS_QUERY, {\r\n        skip: !loaded,\r\n    })\r\n    const initialState = {\r\n        account: {\r\n            update: {} as IAuth['user']\r\n        },\r\n        loading: false,\r\n        response: '',\r\n        changed: false,\r\n        error: null\r\n    }\r\n    const [ state, setState ] = React.useState<UpdateAccountState>(initialState)\r\n    const [ doUpdateAccount ] = useMutation(UPDATE_ACCOUNT_MUTATION)\r\n\r\n    React.useEffect(() => {\r\n        setLoaded(true)\r\n    }, [])\r\n\r\n    if (loading || !data) return <div> ...</div>\r\n\r\n    if (error) return (\r\n        <div>\r\n            <h1> </h1>\r\n            <p>     </p>\r\n        </div>\r\n    )\r\n\r\n    const handleClose = ( e?: React.MouseEvent<HTMLButtonElement> ) => {\r\n        onClose?.()\r\n    }\r\n\r\n    const handleChange = ( e: React.ChangeEvent<HTMLInputElement> | React.ChangeEvent<HTMLSelectElement> ) => {\r\n        const account = users.find((user: IAuth['user']) => user.id === state.account.id) || null\r\n        let changed = true \r\n        if (account && account[e.currentTarget.name] === e.currentTarget.value) {\r\n            changed = false\r\n        }\r\n\r\n        setState({ ...state, changed, account: { ...state.account, update: {...state.account.update, [e.currentTarget.name]: e.currentTarget.value } }})\r\n    }   \r\n\r\n    const handleAccountChoose = ( e: React.ChangeEvent<HTMLSelectElement> ) => {\r\n        const account = users.find((user: IAuth['user']) => user.id === e.currentTarget.value) || null\r\n        setState({ ...initialState, account: { update: account, id: account.id } })\r\n    }\r\n\r\n    const handleSubmit = ( e: React.FormEvent<HTMLFormElement> ) => {\r\n        e.preventDefault()\r\n\r\n        setState({ ...state, loading: true })\r\n        console.log(state.account)\r\n        const { id, firstname, lastname, role } = state.account.update\r\n        const idToUpdate = state.account.id\r\n\r\n        doUpdateAccount({\r\n            variables: {\r\n                input: { target: idToUpdate, id, firstname, lastname, role }\r\n            }\r\n        })\r\n        .then(({ data }) => {\r\n            const { status, response } = data.UpdateAccount\r\n            refetchUsers()\r\n            if (status === 200) return setState({ ...state, response })\r\n        })\r\n        .catch(err => {\r\n            console.log(err)\r\n            setState({ ...state, error: err.message })\r\n        })\r\n    }\r\n\r\n    const items: AddAccountField[] = [\r\n        {\r\n            name: 'id',\r\n            placeholder: ' '\r\n        },\r\n        {\r\n            name: 'firstname',\r\n            placeholder: ' '\r\n        },\r\n        {\r\n            name: 'lastname',\r\n            placeholder: ' '\r\n        }\r\n    ]\r\n\r\n    const { getUsers: users } = data || [] as IAuth['user'][]\r\n    \r\n    return (\r\n        <div className={classes.container}>\r\n            <select className={classes.userSelect} defaultValue=\"0\" onSelect={e => e.currentTarget.blur()} onChange={handleAccountChoose}>\r\n                <option value=\"0\" disabled> </option>\r\n                {\r\n                    users.map((user: IAuth['user'], i: number) => (\r\n                        <option key={i} value={user.id}>{ user.firstname } { user.lastname }</option>\r\n                    ))\r\n                }\r\n            </select>\r\n            {\r\n                Object.keys(state.account.update).length > 0 &&\r\n                <form onSubmit={handleSubmit} className={classes.form} autoComplete=\"off\">\r\n                    <input style={{display: 'none'}} />\r\n                    <div className={classes.fields}>\r\n                        {\r\n                            items.map((field: AddAccountField, i: number) => {\r\n                                const value = state.account.update[field.name]\r\n                                return (\r\n                                    <div key={i} className={classes.field}>\r\n                                        <span>{ field.placeholder }</span>\r\n                                        <input type=\"text\" value={value} name={field.name} placeholder={field.placeholder} onChange={handleChange} />\r\n                                    </div>\r\n                                )\r\n                            })\r\n                        }\r\n                        <div className={classes.field}>\r\n                            <span></span>\r\n                            <select name=\"role\" value={state.account.update.role} onChange={handleChange}>\r\n                                <option value={0} disabled> </option>\r\n                                <option value=\"\"></option>\r\n                                <option value=\"\"></option>\r\n                                <option value=\"\"></option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{ flexDirection: 'row', justifyContent: 'flex-end'}}>\r\n                        <button disabled={!state.changed} type=\"submit\"></button>\r\n                        <button type=\"button\" onClick={handleClose}></button>\r\n                    </div>\r\n                </form>\r\n            }\r\n            {\r\n                state.response && \r\n                <div>\r\n                    { state.response }\r\n                </div>\r\n            }\r\n            {\r\n                state.error &&\r\n                <div>\r\n                    { state.error}\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}","import React from 'react'\r\nimport { IAuth, hasAdminPermission } from '../router'\r\nimport AppNav from './AppNav'\r\nimport { makeStyles, Theme } from '@material-ui/core'\r\nimport {\r\n    ExpandMoreRounded as ArrowDownIcon,\r\n    ExpandLessRounded as ArrowUpIcon\r\n} from '@material-ui/icons'\r\nimport clsx from 'clsx'\r\nimport { AddAccount, UsersList, DeleteUser, UpdateAccount } from './AppSettingsItems'\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    container: {\r\n        minHeight: 'calc(100% - 40px)',\r\n        boxSizing: 'border-box',\r\n        margin: '20px 0',\r\n    },\r\n    item: {\r\n        marginBottom: '12px',\r\n        maxHeight: '40px',\r\n        width: '100%',\r\n        border: '1px solid #eee',\r\n        background: '#fff',\r\n        overflow: 'hidden',\r\n        borderRadius: '8px',\r\n        transition: 'max-height 0.5s linear',\r\n        '&.opened': {\r\n            maxHeight: '100%',\r\n        }\r\n    },\r\n    itemHeader: {\r\n        height: '40px',\r\n        width: '100%',\r\n        background: '#eee',\r\n        '& button': {\r\n            padding: '4px 12px',\r\n            boxSizing: 'border-box',\r\n            flexDirection: 'row',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            fontSize: '16px',\r\n            fontWeight: 500,\r\n            width: '100%',\r\n            height: '100%',\r\n            display: 'flex',\r\n            border: 0,\r\n            background: 0,\r\n            cursor: 'pointer',\r\n            outline: 'none',\r\n            WebkitTapHighlightColor: 'transparent',\r\n        }\r\n    },\r\n    itemContent: {\r\n        minHeight: '40px',\r\n    }\r\n}))\r\n\r\nconst AppSettingsView: React.FC<{ auth: IAuth }> = ({ auth }) => {\r\n    const classes = useStyles()\r\n    const [ open, setOpen ] = React.useState<string | null>(null)\r\n    \r\n    if (!hasAdminPermission(auth)) {\r\n        return (\r\n            <AppNav auth={auth}>\r\n                <div>\r\n                    <h1> !</h1>\r\n                    <p>     </p>\r\n                </div>\r\n            </AppNav>\r\n        )\r\n    }\r\n\r\n    const SettingsItem: React.FC<{ children: JSX.Element | JSX.Element[], title: string }> = ({ children, title }) => {\r\n        return (\r\n            <div className={clsx(classes.item, open === title && 'opened')}>\r\n                <header className={classes.itemHeader}>\r\n                    <button onClick={() => setOpen(open === title ? null : title)}>\r\n                        <h3>{ title }</h3>\r\n                        <div>\r\n                            {\r\n                                open === title \r\n                                ? <ArrowUpIcon />\r\n                                : <ArrowDownIcon />\r\n                            }\r\n                        </div>\r\n                    </button>\r\n                </header>\r\n                {\r\n                    open === title &&\r\n                    <div className={classes.itemContent}>\r\n                        { children }\r\n                    </div>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <AppNav auth={auth}>\r\n            <div className={classes.container}>\r\n                <SettingsItem title=\" \">\r\n                    {\r\n                        open === ' '\r\n                        ? <AddAccount onClose={() => setOpen(null)} />\r\n                        : <div></div>\r\n                    }\r\n                </SettingsItem>\r\n                <SettingsItem title=\"\">\r\n                    <UsersList opened={Boolean(open === '')} onClose={() => setOpen(null)} />\r\n                </SettingsItem>\r\n                <SettingsItem title=\" \">\r\n                    <UpdateAccount opened={Boolean(open === ' ')} onClose={() => setOpen(null)} />\r\n                </SettingsItem>\r\n                <SettingsItem title=\" \">\r\n                    <DeleteUser opened={Boolean(open === ' ')} onClose={() => setOpen(null)} />\r\n                </SettingsItem>\r\n            </div>\r\n        </AppNav>\r\n    )\r\n}\r\n\r\nexport default AppSettingsView","import React from 'react'\r\nimport LoadingPage from './Loading'\r\nimport { useQuery } from '@apollo/client'\r\nimport ErrorPage from './Error'\r\nimport { AUTH_QUERY } from '../apollo/query'\r\nimport HomeView from '../components/HomeView'\r\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\r\nimport LoginView from '../components/LoginView'\r\nimport ProfileView from '../components/ProfileView'\r\nimport AppSettingsView from '../components/AppSettingsView'\r\nimport ShiftView from '../components/ShiftView'\r\n\r\nexport interface IRoute {\r\n    path: string\r\n    name: string\r\n    component: React.FC<any>\r\n    requiresAuth?: true\r\n}\r\n\r\nexport interface IAuth {\r\n    token: string\r\n    user: {\r\n        id: string\r\n        username: string\r\n        firstname: string\r\n        lastname: string\r\n        avatar: string\r\n        role: string\r\n        [key: string]: string\r\n    }\r\n}\r\n\r\nexport const hasAdminPermission: (auth: IAuth) => boolean = (auth: IAuth) => {\r\n    const whiteList = [ 'developer', '', '', 'admin', 'mananger' ]\r\n    return Boolean(whiteList.includes(auth.user.role))\r\n}\r\n\r\nconst routes: IRoute[] = [\r\n    {\r\n        path: '/',\r\n        name: 'Home',\r\n        component: HomeView,\r\n        requiresAuth: true\r\n    },\r\n    {\r\n        path: '/s/:date?/:kind?',\r\n        name: 'Shift',\r\n        component: ShiftView,\r\n        requiresAuth: true\r\n    },\r\n    {\r\n        path: '/p/:username?',\r\n        name: 'Profile',\r\n        component: ProfileView,\r\n        requiresAuth: true\r\n    },\r\n    {\r\n        path: '/app/settings',\r\n        name: 'Application Settings',\r\n        component: AppSettingsView,\r\n        requiresAuth: true\r\n    },\r\n    {\r\n        path: '/login',\r\n        name: 'Login',\r\n        component: LoginView\r\n    }\r\n]\r\n\r\nconst AppRouter: React.FC = () => {\r\n    const { loading, error, data } = useQuery(AUTH_QUERY)\r\n\r\n    if (loading) return <LoadingPage />\r\n\r\n    if (error) return (\r\n        <ErrorPage>\r\n            <p>{error.message}</p>\r\n        </ErrorPage>\r\n    )\r\n    \r\n    const { Authenticate } = data \r\n    const { user, token } = Authenticate\r\n    const auth: IAuth | undefined = user && token ? Authenticate : undefined\r\n\r\n    const AuthRoute: React.FC<{ route: IRoute }> = ({ route }) => {\r\n\r\n        if (route.requiresAuth && !auth) return <Redirect to=\"/login\" />\r\n\r\n        if (!route.requiresAuth && auth && route.name === 'Login') return <Redirect to=\"/\" />\r\n\r\n        if (route.requiresAuth && auth) return <route.component auth={auth} />\r\n\r\n        return (\r\n            <route.component />\r\n        )\r\n    } \r\n\r\n    return (\r\n        <Router>\r\n            <Switch>\r\n                {\r\n                    routes.map((route: IRoute, key: number) => (\r\n                        <Route key={key} exact path={route.path}>\r\n                            <AuthRoute route={route} />\r\n                        </Route>\r\n                    ))\r\n                }\r\n            </Switch>\r\n        </Router>\r\n    )\r\n}\r\n\r\nexport default AppRouter","import React from 'react';\nimport './App.css';\nimport AppRouter from './router';\n\nconst App: React.FC = () => {\n  return (\n    <AppRouter />\n  )\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { split, HttpLink, ApolloProvider, ApolloClient, InMemoryCache } from '@apollo/client'\nimport { getMainDefinition } from '@apollo/client/utilities'\nimport { WebSocketLink } from '@apollo/client/link/ws'\n\nconst PORT: string | number = process.env.PORT || 4000\nconst API_URI: string = process.env.NODE_ENV === 'production' ? `http://${window.location.hostname}:4000/graphql` : `http://${window.location.hostname}:${PORT}/graphql`\nconst WS_URI: string = process.env.NODE_ENV === 'production' ? `ws://${window.location.hostname}:4000/graphql` : `ws://${window.location.hostname}:${PORT}/graphql`\nconst TOKEN: string = localStorage.getItem('token') || ''\n\nconst httpLink: HttpLink = new HttpLink({\n  uri: API_URI,\n  headers: {\n    token: TOKEN\n  }\n})\n\nconst wsLink: WebSocketLink = new WebSocketLink({\n  uri: WS_URI,\n  options: {\n    connectionParams: {\n      token: TOKEN\n    }\n  }\n})\n\nconst link = split(\n  ({ query }) => {\n    const definition = getMainDefinition(query)\n    return (\n      definition.kind === 'OperationDefinition' &&\n      definition.operation === 'subscription'\n    )\n  },\n  wsLink,\n  httpLink\n)\n\nconst client = new ApolloClient({\n  link,\n  cache: new InMemoryCache()\n})\n\nReactDOM.render(\n  <ApolloProvider client={client}>\n    <App />\n  </ApolloProvider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}